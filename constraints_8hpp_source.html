<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ParM: src/constraints.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ParM
   &#160;<span id="projectnumber">parm</span>
   </div>
   <div id="projectbrief">A molecular dynamics library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">constraints.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="constraints_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="interaction_8hpp.html">interaction.hpp</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#ifndef CONSTRAINTS_H</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#define CONSTRAINTS_H</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="constraints_8hpp.html#a98875dff65ee903f41a7ae62c696f935">   15</a></span>&#160;<span class="keyword">typedef</span> std::complex&lt;flt&gt; <a class="code" href="constraints_8hpp.html#a98875dff65ee903f41a7ae62c696f935">cmplx</a>; <span class="comment">// need the std:: for SWIG complex.i, not sure why</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="class_constraint.html">   17</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_constraint.html">Constraint</a> : <span class="keyword">public</span> boost::enable_shared_from_this&lt;Constraint&gt; {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> apply(<a class="code" href="class_box.html">Box</a> &amp;box) = 0;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">int</span> ndof() = 0;</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="class_constraint.html#a0ea4ebf0c039e8c4dac2616a8ec3acd7">   21</a></span>&#160;        <span class="keyword">virtual</span> <a class="code" href="class_constraint.html#a0ea4ebf0c039e8c4dac2616a8ec3acd7">~Constraint</a>(){};</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;};</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="class_coord_constraint.html">   24</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_coord_constraint.html">CoordConstraint</a> : <span class="keyword">public</span> <a class="code" href="class_constraint.html">Constraint</a> {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="struct_atom.html">Atom</a>* a;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordtype">bool</span> fixed[3];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="class_vector2.html">Vec</a> loc;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="class_coord_constraint.html#a6a2c918ebf70b16989b59995aaa94247">   30</a></span>&#160;        <a class="code" href="class_coord_constraint.html#a6a2c918ebf70b16989b59995aaa94247">CoordConstraint</a>(<a class="code" href="struct_atom.html">Atom</a>* atm, <span class="keywordtype">bool</span> fixx, <span class="keywordtype">bool</span> fixy, <span class="keywordtype">bool</span> fixz, <a class="code" href="class_vector2.html">Vec</a> loc) :</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            a(atm), loc(loc) {fixed[0] = fixx; fixed[1] = fixy; fixed[2] = fixz;};</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="class_coord_constraint.html#af7e5f2541fe439ce49575ed199deb228">   32</a></span>&#160;        <a class="code" href="class_coord_constraint.html#af7e5f2541fe439ce49575ed199deb228">CoordConstraint</a>(<a class="code" href="struct_atom.html">Atom</a>* atm, <span class="keywordtype">bool</span> fixx, <span class="keywordtype">bool</span> fixy, <span class="keywordtype">bool</span> fixz) :</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            a(atm), loc(a-&gt;x) {fixed[0] = fixx; fixed[1] = fixy; fixed[2] = fixz;};</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="class_coord_constraint.html#ab513edaad0d51b99defd564ce906ffd9">   34</a></span>&#160;        <a class="code" href="class_coord_constraint.html#ab513edaad0d51b99defd564ce906ffd9">CoordConstraint</a>(<a class="code" href="struct_atom.html">Atom</a>* atm) :</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            a(atm), loc(a-&gt;x) {fixed[0] = fixed[1] = fixed[2] = <span class="keyword">true</span>;};</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="class_coord_constraint.html#ad62706cb02eba5424372911c14a184d6">   36</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="class_coord_constraint.html#ad62706cb02eba5424372911c14a184d6">ndof</a>(){<span class="keywordflow">return</span> (<span class="keywordtype">int</span>)fixed[0] + (int)fixed[1] + (<span class="keywordtype">int</span>)fixed[2];};</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_coord_constraint.html#ac3c8500e01d767afade961496c4b9590">   37</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_coord_constraint.html#ac3c8500e01d767afade961496c4b9590">apply</a>(<a class="code" href="class_box.html">Box</a> &amp;box){</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i&lt;3; i++){</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                <span class="keywordflow">if</span>(not fixed[i]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                a-&gt;<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a>[i] = 0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                a-&gt;<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>[i] = 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                a-&gt;<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a>[i] = loc[i];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;};</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="class_coord_c_o_m_constraint.html">   47</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_coord_c_o_m_constraint.html">CoordCOMConstraint</a> : <span class="keyword">public</span> <a class="code" href="class_constraint.html">Constraint</a> {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        sptr&lt;AtomGroup&gt; a;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordtype">bool</span> fixed[3];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="class_vector2.html">Vec</a> loc;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="class_coord_c_o_m_constraint.html#aafdd12c0fa33fd878946aa070a67f684">   53</a></span>&#160;        <a class="code" href="class_coord_c_o_m_constraint.html#aafdd12c0fa33fd878946aa070a67f684">CoordCOMConstraint</a>(sptr&lt;AtomGroup&gt; atm, <span class="keywordtype">bool</span> fixx, <span class="keywordtype">bool</span> fixy, <span class="keywordtype">bool</span> fixz, <a class="code" href="class_vector2.html">Vec</a> loc) :</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            a(atm), loc(loc) {fixed[0] = fixx; fixed[1] = fixy; fixed[2] = fixz;};</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="class_coord_c_o_m_constraint.html#a8c9381f9f3fd7f0977b3caaa7bea0fea">   55</a></span>&#160;        <a class="code" href="class_coord_c_o_m_constraint.html#a8c9381f9f3fd7f0977b3caaa7bea0fea">CoordCOMConstraint</a>(sptr&lt;AtomGroup&gt; atm, <span class="keywordtype">bool</span> fixx, <span class="keywordtype">bool</span> fixy, <span class="keywordtype">bool</span> fixz) :</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            a(atm), loc(a-&gt;com()) {fixed[0] = fixx; fixed[1] = fixy; fixed[2] = fixz;};</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="class_coord_c_o_m_constraint.html#a93fa3f04c500431f9e91f272330742ac">   57</a></span>&#160;        <a class="code" href="class_coord_c_o_m_constraint.html#a93fa3f04c500431f9e91f272330742ac">CoordCOMConstraint</a>(sptr&lt;AtomGroup&gt; atm) :</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            a(atm), loc(a-&gt;com()) {fixed[0] = fixed[1] = fixed[2] = <span class="keyword">true</span>;};</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="class_coord_c_o_m_constraint.html#a84994dfa35c0134a5778990c6ee86cc3">   59</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="class_coord_c_o_m_constraint.html#a84994dfa35c0134a5778990c6ee86cc3">ndof</a>(){<span class="keywordflow">return</span> (<span class="keywordtype">int</span>)fixed[0] + (int)fixed[1] + (<span class="keywordtype">int</span>)fixed[2];};</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="class_coord_c_o_m_constraint.html#affc7af036b03efe17be9049ec997b4e2">   60</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_coord_c_o_m_constraint.html#affc7af036b03efe17be9049ec997b4e2">apply</a>(<a class="code" href="class_box.html">Box</a> &amp;box){</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> com = a-&gt;com() - loc;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> comv = a-&gt;comv();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> totf = <a class="code" href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a>();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i&lt; a-&gt;size(); i++){</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                totf += (*a)[i].f;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> tota = totf / a-&gt;mass();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i&lt; a-&gt;size(); i++){</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <a class="code" href="struct_atom.html">Atom</a> &amp;atm = (*a)[i];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                <a class="code" href="class_vector2.html">Vec</a> df = (tota * (atm.<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a>));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> j=0; j&lt;3; j++){</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                    <span class="keywordflow">if</span>(not fixed[j]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    atm.<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a>[j] -= df[j];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    atm.<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>[j] -= comv[j];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    atm.<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a>[j] -= com[j];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;};</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="class_relative_constraint.html">   82</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_relative_constraint.html">RelativeConstraint</a> : <span class="keyword">public</span> <a class="code" href="class_constraint.html">Constraint</a> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="struct_atom.html">Atom</a> *a1, *a2;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">bool</span> fixed[3];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="class_vector2.html">Vec</a> loc;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="class_relative_constraint.html#aa9469e72ec7580e59bf05b81143e95f0">   88</a></span>&#160;        <a class="code" href="class_relative_constraint.html#aa9469e72ec7580e59bf05b81143e95f0">RelativeConstraint</a>(<a class="code" href="struct_atom.html">Atom</a>* atm1, <a class="code" href="struct_atom.html">Atom</a>* atm2, <span class="keywordtype">bool</span> fixx, <span class="keywordtype">bool</span> fixy, <span class="keywordtype">bool</span> fixz, <a class="code" href="class_vector2.html">Vec</a> loc) :</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            a1(atm1), a2(atm2), loc(loc) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                fixed[0] = fixx; fixed[1] = fixy; fixed[2] = fixz;};</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="class_relative_constraint.html#a25aed0f2eb158361eecfb33dce5748ec">   91</a></span>&#160;        <a class="code" href="class_relative_constraint.html#a25aed0f2eb158361eecfb33dce5748ec">RelativeConstraint</a>(<a class="code" href="struct_atom.html">Atom</a>* atm1, <a class="code" href="struct_atom.html">Atom</a>* atm2, <span class="keywordtype">bool</span> fixx, <span class="keywordtype">bool</span> fixy, <span class="keywordtype">bool</span> fixz) :</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            a1(atm1), a2(atm2), loc(a2-&gt;x - a1-&gt;x) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                fixed[0] = fixx; fixed[1] = fixy; fixed[2] = fixz;};</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="class_relative_constraint.html#a2f510e334367044ea56ceb73e38bc57a">   94</a></span>&#160;        <a class="code" href="class_relative_constraint.html#a2f510e334367044ea56ceb73e38bc57a">RelativeConstraint</a>(<a class="code" href="struct_atom.html">Atom</a>* atm1, <a class="code" href="struct_atom.html">Atom</a>* atm2) :</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            a1(atm1), a2(atm2), loc(a2-&gt;x - a1-&gt;x) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                fixed[0] = fixed[1] = fixed[2] = <span class="keyword">true</span>;};</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="class_relative_constraint.html#a1d6caf9f9b348b4a9c1fe8933362cff3">   97</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="class_relative_constraint.html#a1d6caf9f9b348b4a9c1fe8933362cff3">ndof</a>(){<span class="keywordflow">return</span> (<span class="keywordtype">int</span>)fixed[0] + (int)fixed[1] + (<span class="keywordtype">int</span>)fixed[2];};</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_relative_constraint.html#a7f2e99140aa174826d4ffe85ad256af9">   98</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_relative_constraint.html#a7f2e99140aa174826d4ffe85ad256af9">apply</a>(<a class="code" href="class_box.html">Box</a> &amp;box){</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> mratio1 = a1-&gt;<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a> / (a1-&gt;<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a> + a2-&gt;<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> mratio2 = a2-&gt;<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a> / (a1-&gt;<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a> + a2-&gt;<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> totf = a2-&gt;<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a> + a1-&gt;<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> dv = a2-&gt;<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a> - a1-&gt;<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> dx = a2-&gt;<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a> - a1-&gt;<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i&lt;<a class="code" href="vecrand_8hpp.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>; i++){</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">if</span>(not fixed[i]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                a1-&gt;<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a>[i] = totf[i]*mratio1;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                a2-&gt;<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a>[i] = totf[i]*mratio2;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                a1-&gt;<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>[i] += dv[i]/2;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                a2-&gt;<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>[i] -= dv[i]/2;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                a1-&gt;<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a>[i] += dx[i]/2;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                a2-&gt;<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a>[i] -= dx[i]/2;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                assert(abs(a2-&gt;<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>[i] - a1-&gt;<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>[i]) &lt; 1e-5);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                assert(abs(a2-&gt;<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a>[i] - a1-&gt;<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a>[i]) &lt; 1e-5);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;};</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="class_dist_constraint.html">  118</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_dist_constraint.html">DistConstraint</a> : <span class="keyword">public</span> <a class="code" href="class_constraint.html">Constraint</a> {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="class_atom_i_d.html">AtomID</a> a1, a2;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> dist;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="class_dist_constraint.html#a34cc6aeba086a133c7f086439fa701af">  123</a></span>&#160;        <a class="code" href="class_dist_constraint.html#a34cc6aeba086a133c7f086439fa701af">DistConstraint</a>(<a class="code" href="class_atom_i_d.html">AtomID</a> atm1, <a class="code" href="class_atom_i_d.html">AtomID</a> atm2, <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> dist) :</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            a1(atm1), a2(atm2), dist(dist) {};</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="class_dist_constraint.html#ac5f88457e0ac34c9bb262565b31e6a1f">  125</a></span>&#160;        <a class="code" href="class_dist_constraint.html#ac5f88457e0ac34c9bb262565b31e6a1f">DistConstraint</a>(<a class="code" href="class_atom_i_d.html">AtomID</a> atm1, <a class="code" href="class_atom_i_d.html">AtomID</a> atm2) :</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            a1(atm1), a2(atm2), dist((a1-&gt;x - a2-&gt;x).mag()){};</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="class_dist_constraint.html#a4f855326894a1fd6541b1d9246c97507">  127</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="class_dist_constraint.html#a4f855326894a1fd6541b1d9246c97507">ndof</a>(){<span class="keywordflow">return</span> 1;};</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="class_dist_constraint.html#aaafab0d44c9c3c07b59498c2c7613cf4">  128</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_dist_constraint.html#aaafab0d44c9c3c07b59498c2c7613cf4">apply</a>(<a class="code" href="class_box.html">Box</a> &amp;box){</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> M = (a1-&gt;m + a2-&gt;m);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> mratio1 = a1-&gt;m / M;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> mratio2 = a2-&gt;m / M;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> dx = a2-&gt;x - a1-&gt;x;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> dxmag = dx.<a class="code" href="class_num_vector.html#a603fd5ea813e3d650e0321c56fd7681e">mag</a>();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> dxnorm = dx / dxmag;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            a1-&gt;x += dx * ((1 - dist/dxmag)*mratio2);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            a2-&gt;x -= dx * ((1 - dist/dxmag)*mratio1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="comment">//~ dx = a2-&gt;x - a1-&gt;x;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="comment">//~ dxmag = dx.mag();</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="comment">//~ dxnorm = dx / dxmag; dxnorm should still be the same</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> baddv = dxnorm * ((a2-&gt;v - a1-&gt;v).dot(dxnorm)/2);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            a1-&gt;v += baddv;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            a2-&gt;v -= baddv;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="comment">// newv2 • u = v2 - |baddv|</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="comment">// newv1 • u = v1 + |baddv|</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="comment">// (newv2 - newv1) • u = (v2 - v1 - (2*baddv)) • u</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="comment">//                     = ((v2 - v1)•u - (2*baddv)•u)</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">//                     = (|baddv|*2 - |baddv|*2) = 0</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="comment">// assert((a2-&gt;v - a1-&gt;v).dot(dxnorm) &lt; 1e-8);</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">if</span>((a2-&gt;v - a1-&gt;v).dot(dxnorm) &gt; 1e-8){</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keywordflow">throw</span> std::overflow_error(<span class="stringliteral">&quot;Velocities are not minimal.&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="comment">// TODO: Fix mass ratio stuff</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> baddf = dxnorm * ((a2-&gt;f - a1-&gt;f).dot(dxnorm)/2);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            a1-&gt;f += baddf;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            a2-&gt;f -= baddf;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">// assert((a2-&gt;f - a1-&gt;f).dot(dxnorm) &lt; 1e-8);</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">if</span>((a2-&gt;f - a1-&gt;f).dot(dxnorm) &gt; 1e-8){</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">throw</span> std::overflow_error(<span class="stringliteral">&quot;Forces are not minimal.&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;};</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="class_linear_constraint.html">  170</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_linear_constraint.html">LinearConstraint</a> : <span class="keyword">public</span> <a class="code" href="class_constraint.html">Constraint</a> {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        sptr&lt;AtomGroup&gt; atms;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> dist;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> lincom, I, M;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="class_linear_constraint.html#abbb34f21cfddbb48c0c44e21d476fd92">  176</a></span>&#160;        <a class="code" href="class_linear_constraint.html#abbb34f21cfddbb48c0c44e21d476fd92">LinearConstraint</a>(sptr&lt;AtomGroup&gt; atms, <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> dist) :</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            atms(atms), dist(dist), lincom(0), I(0), M(0) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i = 0; i &lt; atms-&gt;size(); i++){</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                M += (*atms)[i].m;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                lincom += (dist*i)*(*atms)[i].m;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            lincom /= M;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i = 0; i &lt; atms-&gt;size(); i++){</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> dx = (dist*i - lincom);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                I += (*atms)[i].m * dx * dx;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        };</div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="class_linear_constraint.html#a49fa745cfe1be3d9b2675b6c69f9d5da">  189</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="class_linear_constraint.html#a49fa745cfe1be3d9b2675b6c69f9d5da">ndof</a>(){<span class="keywordflow">return</span> (<span class="keywordtype">int</span>)atms-&gt;size()-1;};</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="class_linear_constraint.html#a74fe045a3c6c1477e146113b5da16ced">  191</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_linear_constraint.html#a74fe045a3c6c1477e146113b5da16ced">apply</a>(<a class="code" href="class_box.html">Box</a> &amp;box){</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> com = atms-&gt;com();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> comv = atms-&gt;comv();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> comf = <a class="code" href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a>();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> sz = atms-&gt;size();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> lvec = <a class="code" href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">            #ifdef VEC3D</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> L = <a class="code" href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a>();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> omega  = <a class="code" href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a>();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> tau = <a class="code" href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <a class="code" href="class_vector2.html">Vec</a> alpha = <a class="code" href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a>();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">            #else</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> L = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> omega = 0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> tau = 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> alpha = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i = 0; i &lt; sz; i++){</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> chaindist = i * dist - lincom;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <a class="code" href="struct_atom.html">Atom</a>&amp; ai = (*atms)[i];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <a class="code" href="class_vector2.html">Vec</a> dx = ai.<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a> - com;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                comf += ai.<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                lvec += dx.<a class="code" href="class_vector2.html#a3818d3aff9ed1bc7c21305b09fb33a8f">norm</a>() * chaindist;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                L += dx.<a class="code" href="class_vector2.html#a198662fae516fb6a0e68762c4ebde34a">cross</a>(ai.<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a>) * ai.<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                tau += dx.<a class="code" href="class_vector2.html#a198662fae516fb6a0e68762c4ebde34a">cross</a>(ai.<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            lvec.<a class="code" href="class_num_vector.html#aa38ce02c0b5fb65f5a3964e359740541">normalize</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            omega = L / I;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            alpha = tau / I;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i = 0; i &lt; sz; i++){</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> chaindist = i * dist - lincom;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <a class="code" href="class_vector2.html">Vec</a> dx = lvec*chaindist;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <a class="code" href="struct_atom.html">Atom</a>&amp; ai = (*atms)[i];</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                ai.<a class="code" href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">x</a> = com + dx;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                ai.<a class="code" href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">v</a> = comv + dx.<a class="code" href="class_vector2.html#a198662fae516fb6a0e68762c4ebde34a">cross</a>(omega);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                ai.<a class="code" href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">f</a> = comf + (dx.cross(alpha)*ai.<a class="code" href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">m</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;};</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="class_contact_tracker.html">  235</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_contact_tracker.html">ContactTracker</a> : <span class="keyword">public</span> <a class="code" href="class_state_tracker.html">StateTracker</a>{</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#a4c28b274a2020a88c9b3375d0dc174c6">  237</a></span>&#160;        sptr&lt;AtomGroup&gt; <a class="code" href="class_contact_tracker.html#a4c28b274a2020a88c9b3375d0dc174c6">atoms</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#a3f4b03698fa20ea84b4c48f62278f703">  238</a></span>&#160;        vector&lt;flt&gt; <a class="code" href="class_contact_tracker.html#a3f4b03698fa20ea84b4c48f62278f703">dists</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#ad7516ade412ead0080e91406325afe65">  239</a></span>&#160;        vector&lt;vector&lt;bool&gt; &gt; <a class="code" href="class_contact_tracker.html#ad7516ade412ead0080e91406325afe65">contacts</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#ae1a598eca5ece1cec374e7037d2d7333">  241</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_contact_tracker.html#ae1a598eca5ece1cec374e7037d2d7333">breaks</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#a6157e5bbe2039091099822beba9bdc16">  242</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_contact_tracker.html#a6157e5bbe2039091099822beba9bdc16">formations</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#af45f49633ef3d6ece7ab2020b16c4f68">  243</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_contact_tracker.html#af45f49633ef3d6ece7ab2020b16c4f68">incontact</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="class_contact_tracker.html">ContactTracker</a>(sptr&lt;Box&gt; box, sptr&lt;AtomGroup&gt; atoms, vector&lt;flt&gt; dists);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordtype">void</span> update(<a class="code" href="class_box.html">Box</a> &amp;box);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#aa229c470aa5fd1dba674bbc57e5a806e">  248</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_contact_tracker.html#aa229c470aa5fd1dba674bbc57e5a806e">broken</a>(){<span class="keywordflow">return</span> breaks;};</div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#aef17b805c851ec2c40d06fa7f8eb35ea">  249</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_contact_tracker.html#aef17b805c851ec2c40d06fa7f8eb35ea">formed</a>(){<span class="keywordflow">return</span> formations;};</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="class_contact_tracker.html#ac10f430ae2791bd8a3c7f91dba68a204">  250</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_contact_tracker.html#ac10f430ae2791bd8a3c7f91dba68a204">number</a>(){<span class="keywordflow">return</span> incontact;};</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;};</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="constraints_8hpp.html#a56a7f494546ed50e702ccbb3943ab5fa">  253</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="class_contact_tracker.html">ContactTracker</a>* <a class="code" href="constraints_8hpp.html#a56a7f494546ed50e702ccbb3943ab5fa">ContactTrackerD</a>(sptr&lt;Box&gt; box, sptr&lt;AtomGroup&gt; atoms, vector&lt;double&gt; dists){</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    vector&lt;flt&gt; newdists = vector&lt;flt&gt;();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i&lt;dists.size(); i++){</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        newdists.push_back(dists[i]);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_contact_tracker.html">ContactTracker</a>(box, atoms, newdists);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="class_energy_tracker.html">  261</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_energy_tracker.html">EnergyTracker</a> : <span class="keyword">public</span> <a class="code" href="class_state_tracker.html">StateTracker</a>{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a8999e08fbf5e88a9cf9f1c1f326b69c0">  263</a></span>&#160;        sptr&lt;AtomGroup&gt; <a class="code" href="class_energy_tracker.html#a8999e08fbf5e88a9cf9f1c1f326b69c0">atoms</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#af6623a30dd262c23d434ceac35abc077">  264</a></span>&#160;        vector&lt;sptr&lt;Interaction&gt; &gt; <a class="code" href="class_energy_tracker.html#af6623a30dd262c23d434ceac35abc077">interactions</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a281304d077243c03c1a13f2f35259852">  266</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_energy_tracker.html#a281304d077243c03c1a13f2f35259852">N</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a5ccb73edc25cc508eed9b32c5ccdb5f3">  267</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nskip, <a class="code" href="class_energy_tracker.html#a5ccb73edc25cc508eed9b32c5ccdb5f3">nskipped</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a827ccea7b8f77d54c7a30cf9d52a8dfc">  268</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#a827ccea7b8f77d54c7a30cf9d52a8dfc">U0</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#ac8400e2fcde88daa5656e1289fb66781">  269</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> Es, <a class="code" href="class_energy_tracker.html#ac8400e2fcde88daa5656e1289fb66781">Us</a>, Ks;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a22992d7fff673730a0d11a0ab95846e4">  270</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> Esq, <a class="code" href="class_energy_tracker.html#a22992d7fff673730a0d11a0ab95846e4">Usq</a>, Ksq;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#aa1bafcc92891abf51aeaf47d72ef98e1">  272</a></span>&#160;        <a class="code" href="class_energy_tracker.html#aa1bafcc92891abf51aeaf47d72ef98e1">EnergyTracker</a>(sptr&lt;AtomGroup&gt; atoms,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            vector&lt;sptr&lt;Interaction&gt; &gt; interactions, <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nskip=1)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;             : atoms(atoms),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            interactions(interactions), N(0), nskip(max(nskip,1u)), nskipped(0),</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            U0(0),Es(0),Us(0),Ks(0), Esq(0), Usq(0), Ksq(0){};</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordtype">void</span> update(<a class="code" href="class_box.html">Box</a> &amp;box);</div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a265e6f30cbb6ad620e6b962f81fe57d5">  278</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_energy_tracker.html#a265e6f30cbb6ad620e6b962f81fe57d5">reset</a>(){</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            nskipped=0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            N=0; Es=0; Us=0; Ks=0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            Esq=0; Usq=0; Ksq=0;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        };</div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a0399e1725ffcb9b4f12b646c01627484">  283</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_energy_tracker.html#a0399e1725ffcb9b4f12b646c01627484">setU0</a>(<a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> newU0){</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            U0 = newU0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            reset();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        };</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">void</span> setU0(<a class="code" href="class_box.html">Box</a> &amp;box);</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a1e784ad0787c2719d2e40ce36267ed09">  288</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#a1e784ad0787c2719d2e40ce36267ed09">getU0</a>(){<span class="keywordflow">return</span> U0;};</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a3eceddb2389f3ca0a4f1d5456bcb54d2">  290</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#a3eceddb2389f3ca0a4f1d5456bcb54d2">E</a>(){<span class="keywordflow">return</span> Es/((<a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a>) N);};</div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#af259293454641985a01978f0cd1fa7b8">  291</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#af259293454641985a01978f0cd1fa7b8">U</a>(){<span class="keywordflow">return</span> Us/((<a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a>) N);};</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#aed7923feb7d9d4bb837d990ab6dc8d33">  292</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#aed7923feb7d9d4bb837d990ab6dc8d33">K</a>(){<span class="keywordflow">return</span> Ks/((<a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a>) N);};</div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a8dd8ab0a88b6c3932eab42f24024dc8a">  293</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#a8dd8ab0a88b6c3932eab42f24024dc8a">Estd</a>(){<span class="keywordflow">return</span> sqrt(Esq/N -Es*Es/N/N);};</div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a3e8b8d6316f902ac49f0d5db52590c7e">  294</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#a3e8b8d6316f902ac49f0d5db52590c7e">Kstd</a>(){<span class="keywordflow">return</span> sqrt(Ksq/N -Ks*Ks/N/N);};</div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#abc220c377db5ec029c57dbc2d2cb29ec">  295</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#abc220c377db5ec029c57dbc2d2cb29ec">Ustd</a>(){<span class="keywordflow">return</span> sqrt(Usq/N -Us*Us/N/N);};</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#aea8afe5a55d082adb681979d16b417f1">  296</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#aea8afe5a55d082adb681979d16b417f1">Esqmean</a>(){<span class="keywordflow">return</span> Esq/N;};</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#aefad2a489a171015e071489ff62df45a">  297</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#aefad2a489a171015e071489ff62df45a">Ksqmean</a>(){<span class="keywordflow">return</span> Ksq/N;};</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a1347926cabcdaf49ad7e1a3ed90b1e8e">  298</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_energy_tracker.html#a1347926cabcdaf49ad7e1a3ed90b1e8e">Usqmean</a>(){<span class="keywordflow">return</span> Usq/N;};</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">//~ flt Ustd(){return sqrt((Usq -(U*U)) / ((flt) N));};</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">//~ flt Kstd(){return sqrt((Ksq -(K*K)) / ((flt) N));};</span></div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="class_energy_tracker.html#a6e664c973e70302e80a9acc225a1a5f2">  301</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_energy_tracker.html#a6e664c973e70302e80a9acc225a1a5f2">n</a>(){<span class="keywordflow">return</span> N;};</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;};</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html">  304</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_rsq_tracker1.html">RsqTracker1</a> {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// Tracks only a single dt (skip)</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html#aca582a0f71bc4646446eb74cd0cf305e">  307</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_rsq_tracker1.html#aca582a0f71bc4646446eb74cd0cf305e">pastlocs</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html#a23c3a82bd57672b51bfcf8b2a5a6873b">  308</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_rsq_tracker1.html#a23c3a82bd57672b51bfcf8b2a5a6873b">xyz2sums</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html#a414c619226bd107b30fb663b342a7cb7">  309</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_rsq_tracker1.html#a414c619226bd107b30fb663b342a7cb7">xyz4sums</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html#a737f29d07b124998250f4c0e808f760c">  310</a></span>&#160;        vector&lt;flt&gt; <a class="code" href="class_rsq_tracker1.html#a737f29d07b124998250f4c0e808f760c">r4sums</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html#a64f4cd5942c1bc9f5c97eb72c29aaf62">  311</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_rsq_tracker1.html#a64f4cd5942c1bc9f5c97eb72c29aaf62">skip</a>, count;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="class_rsq_tracker1.html">RsqTracker1</a>(<a class="code" href="class_atom_group.html">AtomGroup</a>&amp; atoms, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> skip, <a class="code" href="class_vector2.html">Vec</a> com);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordtype">void</span> reset(<a class="code" href="class_atom_group.html">AtomGroup</a>&amp; atoms, <a class="code" href="class_vector2.html">Vec</a> com);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordtype">bool</span> update(<a class="code" href="class_box.html">Box</a>&amp; box, <a class="code" href="class_atom_group.html">AtomGroup</a>&amp; atoms, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> t, <a class="code" href="class_vector2.html">Vec</a> com); <span class="comment">// updates if necessary.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        vector&lt;Vec&gt; xyz2();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        vector&lt;Vec&gt; xyz4();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        vector&lt;flt&gt; r4();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html#a949cd5663c270a95c9826f87b4ab2035">  323</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_rsq_tracker1.html#a949cd5663c270a95c9826f87b4ab2035">get_skip</a>(){<span class="keywordflow">return</span> skip;};</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="class_rsq_tracker1.html#aa2f581a3ebeb03d0ed6d8cf5b47eed61">  324</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_rsq_tracker1.html#aa2f581a3ebeb03d0ed6d8cf5b47eed61">get_count</a>(){<span class="keywordflow">return</span> count;};</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;};</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="class_rsq_tracker.html">  327</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_rsq_tracker.html">RsqTracker</a> : <span class="keyword">public</span> <a class="code" href="class_state_tracker.html">StateTracker</a> {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="class_rsq_tracker.html#a6dd206661ae1eaca4257b1538e79b005">  329</a></span>&#160;        sptr&lt;AtomGroup&gt; <a class="code" href="class_rsq_tracker.html#a6dd206661ae1eaca4257b1538e79b005">atoms</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="class_rsq_tracker.html#a0f124aa083fbb30f654bf845afb135bf">  330</a></span>&#160;        vector&lt;RsqTracker1&gt; <a class="code" href="class_rsq_tracker.html#a0f124aa083fbb30f654bf845afb135bf">singles</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="class_rsq_tracker.html#a413557e906c24199a13c63a997355dac">  331</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_rsq_tracker.html#a413557e906c24199a13c63a997355dac">curt</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="class_rsq_tracker.html#a486be6fb242cfe75454f71b44fccecc3">  332</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_rsq_tracker.html#a486be6fb242cfe75454f71b44fccecc3">usecom</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="class_rsq_tracker.html">RsqTracker</a>(sptr&lt;AtomGroup&gt; atoms, vector&lt;unsigned long&gt; ns, <span class="keywordtype">bool</span> usecom=<span class="keyword">true</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordtype">void</span> reset();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordtype">void</span> update(<a class="code" href="class_box.html">Box</a> &amp;box);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        vector&lt;vector&lt;Vec&gt; &gt; xyz2();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        vector&lt;vector&lt;flt&gt; &gt; r2();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        vector&lt;vector&lt;Vec&gt; &gt; xyz4();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        vector&lt;vector&lt;flt&gt; &gt; r4();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        vector&lt;flt&gt; counts();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;};</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">// ISF tracking</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">// code is similar to Rsqtracker.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">// It tracks ISF(k, Δt) with one ISFTracker1 per Δt.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">// k is of type &#39;flt&#39;, representing a length; it will average over</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">// k(x hat), k(y hat), k(z hat).</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker1.html">  354</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_i_s_f_tracker1.html">ISFTracker1</a> {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Tracks only a single dt (skip)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker1.html#a0841df16cddc5b822f63e276ab985c2a">  357</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_i_s_f_tracker1.html#a0841df16cddc5b822f63e276ab985c2a">pastlocs</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker1.html#ab5c703bcc80a4a84d0ca86586bbaf282">  358</a></span>&#160;        vector&lt;vector&lt;Array&lt;cmplx, NDIM&gt; &gt; &gt; <a class="code" href="class_i_s_f_tracker1.html#ab5c703bcc80a4a84d0ca86586bbaf282">ISFsums</a>; <span class="comment">// (number of ks x number of particles x number of dimensions)</span></div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker1.html#a12ac8e995f34d0a08245c86e0ccee90f">  359</a></span>&#160;        vector&lt;flt&gt; <a class="code" href="class_i_s_f_tracker1.html#a12ac8e995f34d0a08245c86e0ccee90f">ks</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker1.html#a1d4b05f07df1249d4e3c4bcc91ed96f7">  360</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_i_s_f_tracker1.html#a1d4b05f07df1249d4e3c4bcc91ed96f7">skip</a>, count;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="class_i_s_f_tracker1.html">ISFTracker1</a>(<a class="code" href="class_atom_group.html">AtomGroup</a>&amp; atoms, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> skip, vector&lt;flt&gt; ks, <a class="code" href="class_vector2.html">Vec</a> com);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordtype">void</span> reset(<a class="code" href="class_atom_group.html">AtomGroup</a>&amp; atoms, <a class="code" href="class_vector2.html">Vec</a> com);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordtype">bool</span> update(<a class="code" href="class_box.html">Box</a>&amp; box, <a class="code" href="class_atom_group.html">AtomGroup</a>&amp; atoms, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> t, <a class="code" href="class_vector2.html">Vec</a> com); <span class="comment">// updates if necessary.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        vector&lt;vector&lt;cmplx&gt; &gt; ISFs();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        vector&lt;vector&lt;Array&lt;cmplx, NDIM&gt; &gt; &gt; ISFxyz();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker1.html#aef1105b83096742f8de84db09fe311ed">  371</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_i_s_f_tracker1.html#aef1105b83096742f8de84db09fe311ed">get_skip</a>(){<span class="keywordflow">return</span> skip;};</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker1.html#a0bdef0f1a23635870011427c86689061">  372</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_i_s_f_tracker1.html#a0bdef0f1a23635870011427c86689061">get_count</a>(){<span class="keywordflow">return</span> count;};</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;};</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker.html">  375</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_i_s_f_tracker.html">ISFTracker</a> : <span class="keyword">public</span> <a class="code" href="class_state_tracker.html">StateTracker</a> {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker.html#a99b6bdf4b8c3fb5f281264bbe1dd731e">  377</a></span>&#160;        sptr&lt;AtomGroup&gt; <a class="code" href="class_i_s_f_tracker.html#a99b6bdf4b8c3fb5f281264bbe1dd731e">atoms</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker.html#ab5e5c93998d3df2715208807c02c62f0">  378</a></span>&#160;        vector&lt;ISFTracker1&gt; <a class="code" href="class_i_s_f_tracker.html#ab5e5c93998d3df2715208807c02c62f0">singles</a>;</div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker.html#a3683f0399c9cc8ce8dd237288f739d73">  379</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_i_s_f_tracker.html#a3683f0399c9cc8ce8dd237288f739d73">curt</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="class_i_s_f_tracker.html#a06a1d041e94b25f4c4bd66118ce89cbb">  380</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_i_s_f_tracker.html#a06a1d041e94b25f4c4bd66118ce89cbb">usecom</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="class_i_s_f_tracker.html">ISFTracker</a>(sptr&lt;AtomGroup&gt; atoms, vector&lt;flt&gt; ks,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    vector&lt;unsigned long&gt; ns, <span class="keywordtype">bool</span> usecom=<span class="keyword">false</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordtype">void</span> reset();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordtype">void</span> update(<a class="code" href="class_box.html">Box</a> &amp;box);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        vector&lt;vector&lt;vector&lt;Array&lt;cmplx, NDIM&gt; &gt; &gt; &gt; ISFxyz();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        vector&lt;vector&lt;vector&lt;cmplx&gt; &gt; &gt; ISFs();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        vector&lt;flt&gt; counts();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;};</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">// Get the &quot;smoothed&quot; version of each particles location, &quot;smoothed&quot; over windows of a given size</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="class_smooth_locs.html">  397</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_smooth_locs.html">SmoothLocs</a> : <span class="keyword">public</span> <a class="code" href="class_state_tracker.html">StateTracker</a> {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#ac661162122797fe0e6e90c5715b28083">  399</a></span>&#160;        sptr&lt;AtomGroup&gt; <a class="code" href="class_smooth_locs.html#ac661162122797fe0e6e90c5715b28083">atoms</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#a92f5251039b1cb187e19ce62c668e6d5">  400</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_smooth_locs.html#a92f5251039b1cb187e19ce62c668e6d5">smoothn</a>; <span class="comment">// number of skipns to &quot;smooth&quot; over</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#a14849f8023363564e19822e25a22e558">  401</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_smooth_locs.html#a14849f8023363564e19822e25a22e558">skipn</a>; <span class="comment">// number of dts to skip</span></div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#acc3d3c7093af705c807ea5cef9d23ac1">  402</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_smooth_locs.html#acc3d3c7093af705c807ea5cef9d23ac1">curlocs</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#a707d0e39085bfe24fe3940de12e54629">  403</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_smooth_locs.html#a707d0e39085bfe24fe3940de12e54629">numincur</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#aedb148dc27a2a603cfb01814d0854ca7">  404</a></span>&#160;        vector&lt;vector&lt;Vec&gt; &gt; <a class="code" href="class_smooth_locs.html#aedb148dc27a2a603cfb01814d0854ca7">locs</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#a435c08b9ce23a21a59f0b8af6cebe195">  405</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_smooth_locs.html#a435c08b9ce23a21a59f0b8af6cebe195">curt</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#a9cbd03e8474f5207f209f57cbc193182">  406</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_smooth_locs.html#a9cbd03e8474f5207f209f57cbc193182">usecom</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="class_smooth_locs.html">SmoothLocs</a>(sptr&lt;AtomGroup&gt; atoms, <a class="code" href="class_box.html">Box</a> &amp;box, <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> smoothn, <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> skipn=1, <span class="keywordtype">bool</span> usecom=<span class="keyword">false</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordtype">void</span> reset();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">void</span> update(<a class="code" href="class_box.html">Box</a> &amp;box);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="class_smooth_locs.html#ac10d9b9fbc5e1c7673ead640356e45f6">  414</a></span>&#160;        vector&lt;vector&lt;Vec&gt; &gt; <a class="code" href="class_smooth_locs.html#ac10d9b9fbc5e1c7673ead640356e45f6">smooth_locs</a>(){<span class="keywordflow">return</span> locs;};</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;};</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="class_r_diffs.html">  418</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_r_diffs.html">RDiffs</a> : <span class="keyword">public</span> <a class="code" href="class_state_tracker.html">StateTracker</a> {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// Tracks only a single dt (skip)</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="class_r_diffs.html#a5b7a88666b6a1b6fb10bcf2950fb0c41">  421</a></span>&#160;        sptr&lt;AtomGroup&gt; <a class="code" href="class_r_diffs.html#a5b7a88666b6a1b6fb10bcf2950fb0c41">atoms</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="class_r_diffs.html#aafde1d8d4700d9e61e33f67dafdbd74a">  422</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_r_diffs.html#aafde1d8d4700d9e61e33f67dafdbd74a">pastlocs</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="class_r_diffs.html#a211144a5cd263692978244c47b788f0c">  423</a></span>&#160;        vector&lt;vector&lt;flt&gt; &gt; <a class="code" href="class_r_diffs.html#a211144a5cd263692978244c47b788f0c">dists</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="class_r_diffs.html#a3f3ea578bef9f170056ea12bcd2e109d">  424</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_r_diffs.html#a3f3ea578bef9f170056ea12bcd2e109d">skip</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="class_r_diffs.html#a4a31c1226380dc54b8ea7ed4e6369a45">  425</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_r_diffs.html#a4a31c1226380dc54b8ea7ed4e6369a45">curt</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="class_r_diffs.html#ab7293852aaa1bee9283da60f78f8b934">  426</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_r_diffs.html#ab7293852aaa1bee9283da60f78f8b934">usecom</a>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="class_r_diffs.html">RDiffs</a>(sptr&lt;AtomGroup&gt; atoms, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> skip, <span class="keywordtype">bool</span> usecom=<span class="keyword">false</span>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordtype">void</span> reset();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordtype">void</span> update(<a class="code" href="class_box.html">Box</a>&amp; box); <span class="comment">// updates if necessary.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="class_r_diffs.html#a85f884c0b6aa4e9521636f650d039fa7">  433</a></span>&#160;        vector&lt;vector&lt;flt&gt; &gt; <a class="code" href="class_r_diffs.html#a85f884c0b6aa4e9521636f650d039fa7">rdiffs</a>(){<span class="keywordflow">return</span> dists;};</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="class_r_diffs.html#af4926545bd40f681d69063f849fb0f0f">  435</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="class_r_diffs.html#af4926545bd40f681d69063f849fb0f0f">get_skip</a>(){<span class="keywordflow">return</span> skip;};</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;};</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">// For comparing two jammed structures</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">/* We have two packings, A and B, and want to know the sequence {A1, A2, A3...}</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"> * such that particle A1 of packing 1 matches particle 1 of packing B.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"> * A JammingList is a partial list; it has a list {A1 .. An}, with n / N</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"> * particles assigned, with a total distance² of distsq.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="class_jamming_list.html">  446</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_jamming_list.html">JammingList</a> {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="class_jamming_list.html#ae23d48d392b54ecce67f1e468350c501">  448</a></span>&#160;        vector&lt;uint&gt; <a class="code" href="class_jamming_list.html#ae23d48d392b54ecce67f1e468350c501">assigned</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="class_jamming_list.html#a34a07577ff4247dd56473310c7d6078d">  449</a></span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> <a class="code" href="class_jamming_list.html#a34a07577ff4247dd56473310c7d6078d">distsq</a>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="class_jamming_list.html#a0c1f149e504ce5373049052816441ef9">  451</a></span>&#160;        <a class="code" href="class_jamming_list.html#a0c1f149e504ce5373049052816441ef9">JammingList</a>() : assigned(), distsq(0){};</div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="class_jamming_list.html#aff0d3da3074ea7d37d3458e4dc77c484">  452</a></span>&#160;        <a class="code" href="class_jamming_list.html#aff0d3da3074ea7d37d3458e4dc77c484">JammingList</a>(<span class="keyword">const</span> <a class="code" href="class_jamming_list.html">JammingList</a>&amp; other)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            : assigned(other.assigned), distsq(other.distsq){};</div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="class_jamming_list.html#ac776dd9ea451af91ef4398c6b13b76f9">  454</a></span>&#160;        <a class="code" href="class_jamming_list.html#ac776dd9ea451af91ef4398c6b13b76f9">JammingList</a>(<span class="keyword">const</span> <a class="code" href="class_jamming_list.html">JammingList</a>&amp; other, <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> expand, <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> addeddist)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            : assigned(other.size() + 1, 0), distsq(other.distsq + addeddist){</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i &lt; other.<a class="code" href="class_jamming_list.html#a2c07970ca0c85377a1db8a67fa4c5a7c">size</a>(); i++){</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                assigned[i] = other.<a class="code" href="class_jamming_list.html#ae23d48d392b54ecce67f1e468350c501">assigned</a>[i];</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            assigned[assigned.size()-1] = expand;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        }</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="class_jamming_list.html#a2c07970ca0c85377a1db8a67fa4c5a7c">  461</a></span>&#160;        <span class="keyword">inline</span> <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_jamming_list.html#a2c07970ca0c85377a1db8a67fa4c5a7c">size</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> (<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>) assigned.size();};</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordtype">bool</span> operator&lt;(<span class="keyword">const</span> <a class="code" href="class_jamming_list.html">JammingList</a>&amp; other) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;};</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="class_jamming_tree.html">  466</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_jamming_tree.html">JammingTree</a> {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        sptr&lt;Box&gt; box;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        list&lt;JammingList&gt; jlists;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        vector&lt;Vec&gt; A;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        vector&lt;Vec&gt; B;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="class_jamming_tree.html#adf155379664e999aa7b51c9379c2f553">  473</a></span>&#160;        <a class="code" href="class_jamming_tree.html#adf155379664e999aa7b51c9379c2f553">JammingTree</a>(sptr&lt;Box&gt; box, vector&lt;Vec&gt;&amp; A, vector&lt;Vec&gt;&amp; B)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            : box(box), jlists(), A(A), B(B) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            jlists.push_back(<a class="code" href="class_jamming_list.html">JammingList</a>());</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            assert(A.size() &lt;= B.size());</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        };</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="class_jamming_tree.html#acea970f4942b9fc46c9182a8dac390b8">  479</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_jamming_tree.html#acea970f4942b9fc46c9182a8dac390b8">expand</a>(){</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <a class="code" href="class_jamming_list.html">JammingList</a> curjlist = jlists.front();</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            vector&lt;uint&gt;&amp; curlist = curjlist.<a class="code" href="class_jamming_list.html#ae23d48d392b54ecce67f1e468350c501">assigned</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordflow">if</span>(curlist.size() &gt;= A.size()){</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="comment">//~ cout &lt;&lt; &quot;List already too big\n&quot;;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            list&lt;JammingList&gt; newlists = list&lt;JammingList&gt;();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i &lt; B.size(); i++){</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                vector&lt;uint&gt;::iterator found = find(curlist.begin(), curlist.end(), i);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="comment">//if (find(curlist.begin(), curlist.end(), i) != curlist.end()){</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">if</span> (found != curlist.end()){</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    <span class="comment">//~ cout &lt;&lt; &quot;Found &quot; &lt;&lt; i &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    <span class="comment">//cout &lt;&lt; found &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> newdist = box-&gt;diff(A[curlist.size()], B[i]).sq();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <a class="code" href="class_jamming_list.html">JammingList</a> newjlist = <a class="code" href="class_jamming_list.html">JammingList</a>(curjlist, i, newdist);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                newlists.push_back(newjlist);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="comment">//~ cout &lt;&lt; &quot;Made &quot; &lt;&lt; i &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">if</span>(newlists.empty()){</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="comment">//~ cout &lt;&lt; &quot;No lists made\n&quot;;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="comment">//~ cout &lt;&lt; &quot;Have &quot; &lt;&lt; newlists.size() &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            newlists.sort();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="comment">//~ cout &lt;&lt; &quot;Sorted.\n&quot;;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            jlists.pop_front();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="comment">//~ cout &lt;&lt; &quot;Popped.\n&quot;;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            jlists.merge(newlists);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="comment">//~ cout &lt;&lt; &quot;Merged to size &quot; &lt;&lt; jlists.size() &lt;&lt; &quot;best dist now &quot; &lt;&lt; jlists.front().distsq &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        }</div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="class_jamming_tree.html#a081e72e859185b65b41e291cd555fbd2">  515</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_jamming_tree.html#a081e72e859185b65b41e291cd555fbd2">expand</a>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> n){</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="keywordtype">bool</span> retval=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i&lt;n; i++){</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                retval = expand();</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="class_jamming_tree.html#a82be0a097959e3dde6396fc8cb6a3729">  522</a></span>&#160;        list&lt;JammingList&gt; &amp;<a class="code" href="class_jamming_tree.html#a82be0a097959e3dde6396fc8cb6a3729">mylist</a>(){<span class="keywordflow">return</span> jlists;};</div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="class_jamming_tree.html#a1e0e1b6cf259a65052ca187e4372eb88">  523</a></span>&#160;        list&lt;JammingList&gt; <a class="code" href="class_jamming_tree.html#a1e0e1b6cf259a65052ca187e4372eb88">copylist</a>(){<span class="keywordflow">return</span> jlists;};</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="class_jamming_tree.html#a78614c6c0e70e0ee58061b62c89b0a3d">  525</a></span>&#160;        <a class="code" href="class_jamming_list.html">JammingList</a> <a class="code" href="class_jamming_tree.html#a78614c6c0e70e0ee58061b62c89b0a3d">curbest</a>(){</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <a class="code" href="class_jamming_list.html">JammingList</a> j = <a class="code" href="class_jamming_list.html">JammingList</a>(jlists.front());</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="comment">//~ cout &lt;&lt; &quot;Best size: &quot; &lt;&lt; j.size() &lt;&lt; &quot; dist: &quot; &lt;&lt; j.distsq;</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="comment">//~ if(j.size() &gt; 0) cout &lt;&lt; &quot; Elements: [&quot; &lt;&lt; j.assigned[0] &lt;&lt; &quot;, &quot; &lt;&lt; j.assigned[j.size()-1] &lt;&lt; &quot;]&quot;;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="comment">//~ cout &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">return</span> j;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="comment">//return JammingList(jlists.front());</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            };</div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="class_jamming_tree.html#a8d9c6b28f7bd3e65417f7fc77a7bda3c">  533</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_jamming_tree.html#a8d9c6b28f7bd3e65417f7fc77a7bda3c">size</a>(){<span class="keywordflow">return</span> (<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>) jlists.size();};</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;};</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor">#ifdef VEC2D</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="class_jamming_list_rot.html">  538</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_jamming_list_rot.html">JammingListRot</a> : <span class="keyword">public</span> <a class="code" href="class_jamming_list.html">JammingList</a> {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="class_jamming_list_rot.html#ab4dd65c07932cb6d3bb80130d7b9d9ed">  540</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_jamming_list_rot.html#ab4dd65c07932cb6d3bb80130d7b9d9ed">rotation</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="class_jamming_list_rot.html#a4a9c2509801e5b21dff34f6ddd1ff991">  542</a></span>&#160;        <a class="code" href="class_jamming_list_rot.html#a4a9c2509801e5b21dff34f6ddd1ff991">JammingListRot</a>() : <a class="code" href="class_jamming_list.html">JammingList</a>(), rotation(0){};</div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="class_jamming_list_rot.html#ae0d542f308c9fd3cc6a6fd6a81c194df">  543</a></span>&#160;        <a class="code" href="class_jamming_list_rot.html#ae0d542f308c9fd3cc6a6fd6a81c194df">JammingListRot</a>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> rot) : <a class="code" href="class_jamming_list.html">JammingList</a>(), rotation(rot){};</div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="class_jamming_list_rot.html#a56f2810f25efbf358c33c290cfa0ffca">  544</a></span>&#160;        <a class="code" href="class_jamming_list_rot.html#a56f2810f25efbf358c33c290cfa0ffca">JammingListRot</a>(<span class="keyword">const</span> <a class="code" href="class_jamming_list_rot.html">JammingListRot</a>&amp; other)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            : <a class="code" href="class_jamming_list.html">JammingList</a>(other), rotation(other.rotation){};</div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="class_jamming_list_rot.html#aaedc34cc7d4a6a707e76ae131a984cea">  546</a></span>&#160;        <a class="code" href="class_jamming_list_rot.html#aaedc34cc7d4a6a707e76ae131a984cea">JammingListRot</a>(<span class="keyword">const</span> <a class="code" href="class_jamming_list_rot.html">JammingListRot</a>&amp; other, <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> expand, <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> addeddist)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            : <a class="code" href="class_jamming_list.html">JammingList</a>(other, expand, addeddist), rotation(other.rotation){};</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordtype">bool</span> operator&lt;(<span class="keyword">const</span> <a class="code" href="class_jamming_list_rot.html">JammingListRot</a>&amp; other) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;};</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">// Includes rotations, flips, and translations.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html">  553</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_jamming_tree2.html">JammingTree2</a> {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a07a9f1781a298d3f7343ec6a1bf25672">  555</a></span>&#160;        sptr&lt;Box&gt; <a class="code" href="class_jamming_tree2.html#a07a9f1781a298d3f7343ec6a1bf25672">box</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a3d708531e96a7e2667b12e870849c75e">  556</a></span>&#160;        list&lt;JammingListRot&gt; <a class="code" href="class_jamming_tree2.html#a3d708531e96a7e2667b12e870849c75e">jlists</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a8f020fee24984f6ce8833a265352e17d">  557</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_jamming_tree2.html#a8f020fee24984f6ce8833a265352e17d">A</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#aed795b4fbe05fb02c2ec6dea7822123e">  558</a></span>&#160;        vector&lt;vector&lt;Vec&gt; &gt; <a class="code" href="class_jamming_tree2.html#aed795b4fbe05fb02c2ec6dea7822123e">Bs</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// make all 8 possible rotations / flips</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// then subtract off all possible COMVs</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="class_jamming_tree2.html">JammingTree2</a>(sptr&lt;Box&gt;box, vector&lt;Vec&gt;&amp; A, vector&lt;Vec&gt;&amp; B);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> distance(<a class="code" href="class_jamming_list_rot.html">JammingListRot</a>&amp; jlist);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        list&lt;JammingListRot&gt; expand(<a class="code" href="class_jamming_list_rot.html">JammingListRot</a> curjlist);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> expand();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a69eb00e292aa49fbc5f56d1b08436675">  568</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_jamming_tree2.html#a69eb00e292aa49fbc5f56d1b08436675">expand</a>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> n){</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordtype">bool</span> retval=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i&lt;n; i++){</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                retval = expand();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="keywordflow">if</span>(!retval) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a58010eabf4da6aa6e9d73c2f82783350">  576</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_jamming_tree2.html#a58010eabf4da6aa6e9d73c2f82783350">expandto</a>(<a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> maxdistsq){</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordtype">bool</span> retval = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="keywordflow">while</span>((maxdistsq &lt;= 0 or jlists.front().distsq &lt; maxdistsq) and retval){</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                retval = expand();</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            };</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keyword">static</span> <a class="code" href="class_vector2.html">Vec</a> straight_diff(<a class="code" href="class_box.html">Box</a> &amp;bx, vector&lt;Vec&gt;&amp; A, vector&lt;Vec&gt;&amp; B);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keyword">static</span> <a class="code" href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a> straight_distsq(<a class="code" href="class_box.html">Box</a> &amp;bx, vector&lt;Vec&gt;&amp; A, vector&lt;Vec&gt;&amp; B);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#ab7c6385a76250e0c72dd8b763de5e4c1">  586</a></span>&#160;        list&lt;JammingListRot&gt; &amp;<a class="code" href="class_jamming_tree2.html#ab7c6385a76250e0c72dd8b763de5e4c1">mylist</a>(){<span class="keywordflow">return</span> jlists;};</div>
<div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a60e7f8b0408b17d12bf1efeff1e5e8dc">  587</a></span>&#160;        list&lt;JammingListRot&gt; <a class="code" href="class_jamming_tree2.html#a60e7f8b0408b17d12bf1efeff1e5e8dc">copylist</a>(){<span class="keywordflow">return</span> jlists;};</div>
<div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#ac3f75594659c0951880d6d0a123c781d">  588</a></span>&#160;        list&lt;JammingListRot&gt; <a class="code" href="class_jamming_tree2.html#ac3f75594659c0951880d6d0a123c781d">copylist</a>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> n){</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            list&lt;JammingListRot&gt;::iterator last = jlists.begin();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            advance(last, n);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">return</span> list&lt;JammingListRot&gt;(jlists.begin(), last);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        };</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#af1c79da430cfc0606167c21e2f7ea232">  595</a></span>&#160;        <a class="code" href="class_jamming_list_rot.html">JammingListRot</a> <a class="code" href="class_jamming_tree2.html#af1c79da430cfc0606167c21e2f7ea232">curbest</a>(){</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="keywordflow">if</span>(jlists.empty()){</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                <a class="code" href="class_jamming_list_rot.html">JammingListRot</a> bad_list = <a class="code" href="class_jamming_list_rot.html">JammingListRot</a>();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                bad_list.<a class="code" href="class_jamming_list.html#a34a07577ff4247dd56473310c7d6078d">distsq</a> = -1;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <span class="keywordflow">return</span> bad_list;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <a class="code" href="class_jamming_list_rot.html">JammingListRot</a> j = <a class="code" href="class_jamming_list_rot.html">JammingListRot</a>(jlists.front());</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="comment">//~ cout &lt;&lt; &quot;Best size: &quot; &lt;&lt; j.size() &lt;&lt; &quot; dist: &quot; &lt;&lt; j.distsq;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">//~ if(j.size() &gt; 0) cout &lt;&lt; &quot; Elements: [&quot; &lt;&lt; j.assigned[0] &lt;&lt; &quot;, &quot; &lt;&lt; j.assigned[j.size()-1] &lt;&lt; &quot;]&quot;;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment">//~ cout &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">return</span> j;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="comment">//return JammingList(jlists.front());</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            };</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">//JammingListRot operator[](uint i){</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment">//    assert(i &lt; jlists.size());</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">//    return JammingListRot(jlists[i]);</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">//};</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#ae04554aa1577d868046f6dc42ca32958">  614</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_jamming_tree2.html#ae04554aa1577d868046f6dc42ca32958">size</a>(){<span class="keywordflow">return</span> (<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>) jlists.size();};</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        vector&lt;Vec&gt; locationsB(<a class="code" href="class_jamming_list_rot.html">JammingListRot</a> jlist);</div>
<div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#ae921105d208e514f8389c8e8e1a1fcd9">  617</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_jamming_tree2.html#ae921105d208e514f8389c8e8e1a1fcd9">locationsB</a>(){<span class="keywordflow">return</span> <a class="code" href="class_jamming_tree2.html#ae921105d208e514f8389c8e8e1a1fcd9">locationsB</a>(curbest());};</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        vector&lt;Vec&gt; locationsA(<a class="code" href="class_jamming_list_rot.html">JammingListRot</a> jlist);</div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a600c8887f767080548ff82b3a3afd4cb">  619</a></span>&#160;        vector&lt;Vec&gt; <a class="code" href="class_jamming_tree2.html#a600c8887f767080548ff82b3a3afd4cb">locationsA</a>(){<span class="keywordflow">return</span> <a class="code" href="class_jamming_tree2.html#a600c8887f767080548ff82b3a3afd4cb">locationsA</a>(curbest());};</div>
<div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="class_jamming_tree2.html#a56c397c705d88ab4aebe80ba391aaf43">  620</a></span>&#160;        <span class="keyword">virtual</span> <a class="code" href="class_jamming_tree2.html#a56c397c705d88ab4aebe80ba391aaf43">~JammingTree2</a>(){};</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;};</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="class_jamming_tree_b_d.html">  624</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_jamming_tree_b_d.html">JammingTreeBD</a> : <span class="keyword">public</span> <a class="code" href="class_jamming_tree2.html">JammingTree2</a> {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">/* For a bi-disperse packing.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">     * &#39;cutoff&#39; is the number of particles of the first kind; i.e., the</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">     * A vector should have A[0]..A[cutoff-1] be of particle type 1,</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">     * and A[cutoff]..A[N-1] of particle type 2.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">     * This does much the same as JammingTree2, but doesn&#39;t check any</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">     * reordering in which particles of one type are relabeled as another.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">     * For exampe, with 2+2 particles (cutoff 2), we check</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">     * [0123],[1023],[0132],[1032]</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">     * But not</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">     * [0213],[0231],[0312],[0321],[1203],[1230],[1302],[1320],...</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">     * This means at most (cutoff! (N-cutoff)!) combinations are checked,</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">     * and not all N!, which can save a lot of time (as well as</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">     *  rejecting false combinations).</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="class_jamming_tree_b_d.html#a7f5e926c7a274fc354eea40f8b86ab35">  640</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> cutoff1,<a class="code" href="class_jamming_tree_b_d.html#a7f5e926c7a274fc354eea40f8b86ab35">cutoff2</a>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="class_jamming_tree_b_d.html#ad1fd076a782dea297d69caa5b36db751">  642</a></span>&#160;        <a class="code" href="class_jamming_tree_b_d.html#ad1fd076a782dea297d69caa5b36db751">JammingTreeBD</a>(sptr&lt;Box&gt;box, vector&lt;Vec&gt;&amp; A, vector&lt;Vec&gt;&amp; B, <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> cutoff) :</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <a class="code" href="class_jamming_tree2.html">JammingTree2</a>(box, A, B), cutoff1(cutoff), cutoff2(cutoff){};</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="class_jamming_tree_b_d.html">JammingTreeBD</a>(sptr&lt;Box&gt;box, vector&lt;Vec&gt;&amp; A, vector&lt;Vec&gt;&amp; B,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> cutoffA, <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> cutoffB);<span class="comment">// :</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="comment">//JammingTree2(box, A, B), cutoff1(cutoffA), cutoff2(cutoffB){};</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        list&lt;JammingListRot&gt; expand(<a class="code" href="class_jamming_list_rot.html">JammingListRot</a> curjlist);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordtype">bool</span> expand();</div>
<div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="class_jamming_tree_b_d.html#a8f5b0e7fd87e308ec2f57a9e1c20900a">  650</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_jamming_tree_b_d.html#a8f5b0e7fd87e308ec2f57a9e1c20900a">expand</a>(<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> n){<span class="keywordflow">return</span> <a class="code" href="class_jamming_tree2.html#a07e970229143e9cf09e56d1b3e7f26b2">JammingTree2::expand</a>(n);};</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;};</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">/* Finding Percolation</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"> * Plan:</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment"> * struct Node {</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"> *      uint n;</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"> *      Vec x;</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"> * }</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> * struct Connectivity {</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> *      sptr&lt;OriginBox&gt;;</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> *      vector&lt;Node&gt; nodes;</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"> *      set&lt;Node, vector&lt;Node&gt; &gt; neighbors; # with both directions in</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"> * }</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment"> * make_connectivity(sptr&lt;OriginBox&gt;, NListed&lt;A,P&gt;) {</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"> *      # for each pair, if energy != 0, add it to the Connectivity</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"> * }</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"> * or</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment"> * make_connectivity(sptr&lt;OriginBox&gt;, NeighborList, ... sigmas) {</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"> *      # for each pair, if box.diff(a1.x, a2.x) &lt; (sigma1 &lt; sigma2)/2, add it to the list</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment"> * }</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment"> * struct Path {</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment"> *      Vec&lt;uint&gt; distance          # Euclidean distance from first node to last. Note this is not</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment"> *                                  #   the same as box.diff(last - first), because it might go</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"> *                                  #   a longer way around the box</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"> *      vector&lt;uint&gt; nodes          # nodes visited</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"> * }</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"> * Maybe implement &lt;, ==, &gt; by using length of nodes first and what the nodes are second</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> * Implement ... circular_from(uint n, check_all=true):</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"> *  -   Do a breadth-first search starting from n, including only nodes &gt; n.</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"> *  -   While searching, build map&lt;node, path&gt;, which is the Euclidean distance from the start node</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"> *      to the current node via the path traveled</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"> *  -   If you get to an already visited node, compare the current Vec path to the previous one. If</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"> *      the same:</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment"> *      -   either replace the old path (if new_path &lt; old_path) or don&#39;t</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment"> *      -   Do not follow connections</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"> *      If different, we&#39;ve found a percolation:</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"> *      -   Mark percolations with &quot;map&lt;uint, path&gt; cycles&quot;; the key is the dimension, and</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"> *          the value (vector&lt;uint&gt;) is the path.</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"> *      -   If(check_all &amp;&amp; cycles.size() &gt;= 1) return cycles</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"> *      -   else if cycles.size() &gt;= NDIM return cycles</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"> *  -   If you finish without finding any (or enough), return cycles</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment"> * Implement ... find_percolation(...):</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"> *  -   for each n, run circular_from(uint n, false)</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"> *  -   if any have a cycle, return it!</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"> * Implement ... find_percolations(...):</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"> *  -   for each n, run circular_from(uint n, true)</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"> *  -   keep merging results</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment"> *  -   if cycles.size() &gt;= NDIM return cycles</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"> *  -   if you get to the end, return cycles</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="class_c_node.html">  714</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_node.html">CNode</a> {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="class_c_node.html#a4c6976bcd30cf7257638ae368a4925a1">  716</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="class_c_node.html#a4c6976bcd30cf7257638ae368a4925a1">n</a>;</div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="class_c_node.html#a7453a05ead8a62aaf1ee156b31c21f75">  717</a></span>&#160;        <a class="code" href="class_vector2.html">Vec</a> <a class="code" href="class_c_node.html#a7453a05ead8a62aaf1ee156b31c21f75">x</a>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno"><a class="line" href="class_c_node.html#a92f7b783eb6349154976e1f8229898a5">  719</a></span>&#160;        <a class="code" href="class_c_node.html#a92f7b783eb6349154976e1f8229898a5">CNode</a>() : n(-1){};</div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="class_c_node.html#afa985f833a9c58c5bb0012f6167b7bc1">  720</a></span>&#160;        <a class="code" href="class_c_node.html#afa985f833a9c58c5bb0012f6167b7bc1">CNode</a>(<span class="keywordtype">int</span> n, <a class="code" href="class_vector2.html">Vec</a> x) : n(n), x(x){};</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="class_c_node.html#a851ec2cb1c285639c17f14eb4e243325">  722</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_c_node.html#a851ec2cb1c285639c17f14eb4e243325">operator!=</a>(<span class="keyword">const</span> <a class="code" href="class_c_node.html">CNode</a>&amp; other)<span class="keyword">  const </span>{ <span class="keywordflow">return</span> n != other.<a class="code" href="class_c_node.html#a4c6976bcd30cf7257638ae368a4925a1">n</a>;};</div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="class_c_node.html#aae3afff4d45adf923d66cab84494a289">  723</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_c_node.html#aae3afff4d45adf923d66cab84494a289">operator==</a>(<span class="keyword">const</span> <a class="code" href="class_c_node.html">CNode</a>&amp; other)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> n == other.<a class="code" href="class_c_node.html#a4c6976bcd30cf7257638ae368a4925a1">n</a>;};</div>
<div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="class_c_node.html#a9a96d5aab5f529da0e4cb392d994daed">  724</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_c_node.html#a9a96d5aab5f529da0e4cb392d994daed">operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="class_c_node.html">CNode</a>&amp; other)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> n &lt; other.<a class="code" href="class_c_node.html#a4c6976bcd30cf7257638ae368a4925a1">n</a>;};</div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="class_c_node.html#a5370ebfe28147d9fa550dae7ae403b85">  725</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_c_node.html#a5370ebfe28147d9fa550dae7ae403b85">operator&gt;</a>(<span class="keyword">const</span> <a class="code" href="class_c_node.html">CNode</a>&amp; other)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> n &gt; other.<a class="code" href="class_c_node.html#a4c6976bcd30cf7257638ae368a4925a1">n</a>;};</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;};</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno"><a class="line" href="class_c_node_path.html">  728</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_node_path.html">CNodePath</a> {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00730"></a><span class="lineno"><a class="line" href="class_c_node_path.html#a48f9ad48fa803948dcbbafd75ce4e127">  730</a></span>&#160;        <a class="code" href="class_vector2.html">Vec</a> <a class="code" href="class_c_node_path.html#a48f9ad48fa803948dcbbafd75ce4e127">distance</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="class_c_node_path.html#ad0b03716c543195d81f3a2596ba683b2">  731</a></span>&#160;        vector&lt;CNode&gt; <a class="code" href="class_c_node_path.html#ad0b03716c543195d81f3a2596ba683b2">nodes</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="class_c_node_path.html#ac5ec833a6f8aae17311f68964411ce44">  734</a></span>&#160;        <a class="code" href="class_c_node_path.html#ac5ec833a6f8aae17311f68964411ce44">CNodePath</a>(){};</div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="class_c_node_path.html#a998869fe7400bcac2a21d55a0dbc9b5e">  735</a></span>&#160;        <a class="code" href="class_c_node_path.html#a998869fe7400bcac2a21d55a0dbc9b5e">CNodePath</a>(<a class="code" href="class_c_node.html">CNode</a> node){nodes.push_back(node);};</div>
<div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="class_c_node_path.html#a812d8493554ba776ee0f9a9856ab1367">  736</a></span>&#160;        <a class="code" href="class_c_node_path.html#a812d8493554ba776ee0f9a9856ab1367">CNodePath</a>(<a class="code" href="class_c_node_path.html">CNodePath</a> other, <a class="code" href="class_c_node.html">CNode</a> node, <a class="code" href="class_origin_box.html">OriginBox</a>&amp; box) :</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            distance(other.distance), nodes(other.nodes){add(node, box);};</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordtype">void</span> add(<a class="code" href="class_c_node.html">CNode</a> node, <a class="code" href="class_origin_box.html">OriginBox</a>&amp; box);</div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="class_c_node_path.html#a1503a97fceebe308da3a1729318b7b59">  739</a></span>&#160;        <a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="class_c_node_path.html#a1503a97fceebe308da3a1729318b7b59">size</a>(){<span class="keywordflow">return</span> (<a class="code" href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>) nodes.size();};</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;};</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">// The class that actually finds percolation.</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">// TODO:</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"> * add a way to work with a NeighborList for initial construction</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="class_connectivity.html">  748</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_connectivity.html">Connectivity</a> {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="class_connectivity.html#ab8feefc9918cca72b803df732c4fa620">  750</a></span>&#160;        sptr&lt;OriginBox&gt; <a class="code" href="class_connectivity.html#ab8feefc9918cca72b803df732c4fa620">box</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno"><a class="line" href="class_connectivity.html#af38ff9c44b157ba74e6a06e1452f63ef">  751</a></span>&#160;        set&lt;CNode&gt; <a class="code" href="class_connectivity.html#af38ff9c44b157ba74e6a06e1452f63ef">nodes</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="class_connectivity.html#a1cd65e0f1306878804459294114589a2">  752</a></span>&#160;        map&lt;int, vector&lt;CNode&gt; &gt; <a class="code" href="class_connectivity.html#a1cd65e0f1306878804459294114589a2">neighbors</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        array&lt;bool, NDIM&gt; nonzero(<a class="code" href="class_vector2.html">Vec</a> diff_vec); <span class="comment">// is it nonzero. Specifically, is any dimension &gt;  L/2?</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <a class="code" href="class_c_node_path.html">CNodePath</a> make_cycle(<a class="code" href="class_c_node_path.html">CNodePath</a> forward, <a class="code" href="class_c_node_path.html">CNodePath</a> backward);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        map&lt;uint, CNodePath&gt; circular_from(<a class="code" href="class_c_node.html">CNode</a> node, set&lt;uint&gt;&amp; visited, <span class="keywordtype">bool</span> check_all);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="class_connectivity.html#a9f0cb48a74aedf06578097551919a14a">  760</a></span>&#160;        <a class="code" href="class_connectivity.html#a9f0cb48a74aedf06578097551919a14a">Connectivity</a>(sptr&lt;OriginBox&gt; box) : box(box){};</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordtype">void</span> add_edge(<a class="code" href="class_c_node.html">CNode</a> node1, <a class="code" href="class_c_node.html">CNode</a> node2);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="comment">// assumes diameters are additive</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="comment">// Note that &quot;diameter&quot; should generally be the attractive diameter</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordtype">void</span> add(vector&lt;Vec&gt; locs, vector&lt;flt&gt; diameters);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        map&lt;uint, CNodePath&gt; find_percolation(<span class="keywordtype">bool</span> check_all_dims=<span class="keyword">true</span>);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;};</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="class_r_diffs_html_aafde1d8d4700d9e61e33f67dafdbd74a"><div class="ttname"><a href="class_r_diffs.html#aafde1d8d4700d9e61e33f67dafdbd74a">RDiffs::pastlocs</a></div><div class="ttdeci">vector&lt; Vec &gt; pastlocs</div><div class="ttdef"><b>Definition:</b> constraints.hpp:422</div></div>
<div class="ttc" id="class_energy_tracker_html_a22992d7fff673730a0d11a0ab95846e4"><div class="ttname"><a href="class_energy_tracker.html#a22992d7fff673730a0d11a0ab95846e4">EnergyTracker::Usq</a></div><div class="ttdeci">flt Usq</div><div class="ttdef"><b>Definition:</b> constraints.hpp:270</div></div>
<div class="ttc" id="class_c_node_path_html_ad0b03716c543195d81f3a2596ba683b2"><div class="ttname"><a href="class_c_node_path.html#ad0b03716c543195d81f3a2596ba683b2">CNodePath::nodes</a></div><div class="ttdeci">vector&lt; CNode &gt; nodes</div><div class="ttdef"><b>Definition:</b> constraints.hpp:731</div></div>
<div class="ttc" id="class_jamming_tree2_html_a8f020fee24984f6ce8833a265352e17d"><div class="ttname"><a href="class_jamming_tree2.html#a8f020fee24984f6ce8833a265352e17d">JammingTree2::A</a></div><div class="ttdeci">vector&lt; Vec &gt; A</div><div class="ttdef"><b>Definition:</b> constraints.hpp:557</div></div>
<div class="ttc" id="class_energy_tracker_html_a8dd8ab0a88b6c3932eab42f24024dc8a"><div class="ttname"><a href="class_energy_tracker.html#a8dd8ab0a88b6c3932eab42f24024dc8a">EnergyTracker::Estd</a></div><div class="ttdeci">flt Estd()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:293</div></div>
<div class="ttc" id="class_i_s_f_tracker1_html_ab5c703bcc80a4a84d0ca86586bbaf282"><div class="ttname"><a href="class_i_s_f_tracker1.html#ab5c703bcc80a4a84d0ca86586bbaf282">ISFTracker1::ISFsums</a></div><div class="ttdeci">vector&lt; vector&lt; Array&lt; cmplx, NDIM &gt; &gt; &gt; ISFsums</div><div class="ttdef"><b>Definition:</b> constraints.hpp:358</div></div>
<div class="ttc" id="struct_atom_html"><div class="ttname"><a href="struct_atom.html">Atom</a></div><div class="ttdoc">The basic class for representing each particle. </div><div class="ttdef"><b>Definition:</b> box.hpp:218</div></div>
<div class="ttc" id="class_jamming_tree_html_a1e0e1b6cf259a65052ca187e4372eb88"><div class="ttname"><a href="class_jamming_tree.html#a1e0e1b6cf259a65052ca187e4372eb88">JammingTree::copylist</a></div><div class="ttdeci">list&lt; JammingList &gt; copylist()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:523</div></div>
<div class="ttc" id="class_contact_tracker_html_a6157e5bbe2039091099822beba9bdc16"><div class="ttname"><a href="class_contact_tracker.html#a6157e5bbe2039091099822beba9bdc16">ContactTracker::formations</a></div><div class="ttdeci">unsigned long long formations</div><div class="ttdef"><b>Definition:</b> constraints.hpp:242</div></div>
<div class="ttc" id="vecrand_8hpp_html_a3f96c19973963f3408a8e6e5b76d8387"><div class="ttname"><a href="vecrand_8hpp.html#a3f96c19973963f3408a8e6e5b76d8387">Vec</a></div><div class="ttdeci">Vector2&lt; flt &gt; Vec</div><div class="ttdoc">The basic physics vector. </div><div class="ttdef"><b>Definition:</b> vecrand.hpp:47</div></div>
<div class="ttc" id="class_connectivity_html_a9f0cb48a74aedf06578097551919a14a"><div class="ttname"><a href="class_connectivity.html#a9f0cb48a74aedf06578097551919a14a">Connectivity::Connectivity</a></div><div class="ttdeci">Connectivity(sptr&lt; OriginBox &gt; box)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:760</div></div>
<div class="ttc" id="class_r_diffs_html_a211144a5cd263692978244c47b788f0c"><div class="ttname"><a href="class_r_diffs.html#a211144a5cd263692978244c47b788f0c">RDiffs::dists</a></div><div class="ttdeci">vector&lt; vector&lt; flt &gt; &gt; dists</div><div class="ttdef"><b>Definition:</b> constraints.hpp:423</div></div>
<div class="ttc" id="class_jamming_tree2_html_aed795b4fbe05fb02c2ec6dea7822123e"><div class="ttname"><a href="class_jamming_tree2.html#aed795b4fbe05fb02c2ec6dea7822123e">JammingTree2::Bs</a></div><div class="ttdeci">vector&lt; vector&lt; Vec &gt; &gt; Bs</div><div class="ttdef"><b>Definition:</b> constraints.hpp:558</div></div>
<div class="ttc" id="class_energy_tracker_html_a1347926cabcdaf49ad7e1a3ed90b1e8e"><div class="ttname"><a href="class_energy_tracker.html#a1347926cabcdaf49ad7e1a3ed90b1e8e">EnergyTracker::Usqmean</a></div><div class="ttdeci">flt Usqmean()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:298</div></div>
<div class="ttc" id="class_jamming_tree2_html_a69eb00e292aa49fbc5f56d1b08436675"><div class="ttname"><a href="class_jamming_tree2.html#a69eb00e292aa49fbc5f56d1b08436675">JammingTree2::expand</a></div><div class="ttdeci">bool expand(uint n)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:568</div></div>
<div class="ttc" id="struct_atom_html_a41ae63c2ba1e69986456ae9ed269ddc0"><div class="ttname"><a href="struct_atom.html#a41ae63c2ba1e69986456ae9ed269ddc0">Atom::m</a></div><div class="ttdeci">flt m</div><div class="ttdoc">mass </div><div class="ttdef"><b>Definition:</b> box.hpp:232</div></div>
<div class="ttc" id="class_atom_group_html"><div class="ttname"><a href="class_atom_group.html">AtomGroup</a></div><div class="ttdoc">a group of atoms, such as all of them (AtomVec), or a smaller group such as a molecule, sidebranch, etc. </div><div class="ttdef"><b>Definition:</b> box.hpp:298</div></div>
<div class="ttc" id="class_jamming_list_rot_html_a56f2810f25efbf358c33c290cfa0ffca"><div class="ttname"><a href="class_jamming_list_rot.html#a56f2810f25efbf358c33c290cfa0ffca">JammingListRot::JammingListRot</a></div><div class="ttdeci">JammingListRot(const JammingListRot &amp;other)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:544</div></div>
<div class="ttc" id="class_constraint_html_a0ea4ebf0c039e8c4dac2616a8ec3acd7"><div class="ttname"><a href="class_constraint.html#a0ea4ebf0c039e8c4dac2616a8ec3acd7">Constraint::~Constraint</a></div><div class="ttdeci">virtual ~Constraint()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:21</div></div>
<div class="ttc" id="class_rsq_tracker_html_a413557e906c24199a13c63a997355dac"><div class="ttname"><a href="class_rsq_tracker.html#a413557e906c24199a13c63a997355dac">RsqTracker::curt</a></div><div class="ttdeci">unsigned long curt</div><div class="ttdef"><b>Definition:</b> constraints.hpp:331</div></div>
<div class="ttc" id="class_r_diffs_html_a85f884c0b6aa4e9521636f650d039fa7"><div class="ttname"><a href="class_r_diffs.html#a85f884c0b6aa4e9521636f650d039fa7">RDiffs::rdiffs</a></div><div class="ttdeci">vector&lt; vector&lt; flt &gt; &gt; rdiffs()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:433</div></div>
<div class="ttc" id="class_energy_tracker_html_aed7923feb7d9d4bb837d990ab6dc8d33"><div class="ttname"><a href="class_energy_tracker.html#aed7923feb7d9d4bb837d990ab6dc8d33">EnergyTracker::K</a></div><div class="ttdeci">flt K()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:292</div></div>
<div class="ttc" id="class_coord_c_o_m_constraint_html_a84994dfa35c0134a5778990c6ee86cc3"><div class="ttname"><a href="class_coord_c_o_m_constraint.html#a84994dfa35c0134a5778990c6ee86cc3">CoordCOMConstraint::ndof</a></div><div class="ttdeci">int ndof()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:59</div></div>
<div class="ttc" id="vec_8hpp_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="vec_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> vec.hpp:20</div></div>
<div class="ttc" id="class_contact_tracker_html_aef17b805c851ec2c40d06fa7f8eb35ea"><div class="ttname"><a href="class_contact_tracker.html#aef17b805c851ec2c40d06fa7f8eb35ea">ContactTracker::formed</a></div><div class="ttdeci">unsigned long long formed()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:249</div></div>
<div class="ttc" id="class_num_vector_html_aa38ce02c0b5fb65f5a3964e359740541"><div class="ttname"><a href="class_num_vector.html#aa38ce02c0b5fb65f5a3964e359740541">NumVector::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdoc">Normalize in place. </div><div class="ttdef"><b>Definition:</b> vec.hpp:507</div></div>
<div class="ttc" id="struct_atom_html_abe9c3b8a5bc4c8dbde607f08a8915af5"><div class="ttname"><a href="struct_atom.html#abe9c3b8a5bc4c8dbde607f08a8915af5">Atom::x</a></div><div class="ttdeci">Vec x</div><div class="ttdoc">location. </div><div class="ttdef"><b>Definition:</b> box.hpp:220</div></div>
<div class="ttc" id="class_coord_c_o_m_constraint_html_a8c9381f9f3fd7f0977b3caaa7bea0fea"><div class="ttname"><a href="class_coord_c_o_m_constraint.html#a8c9381f9f3fd7f0977b3caaa7bea0fea">CoordCOMConstraint::CoordCOMConstraint</a></div><div class="ttdeci">CoordCOMConstraint(sptr&lt; AtomGroup &gt; atm, bool fixx, bool fixy, bool fixz)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:55</div></div>
<div class="ttc" id="class_c_node_html_a92f7b783eb6349154976e1f8229898a5"><div class="ttname"><a href="class_c_node.html#a92f7b783eb6349154976e1f8229898a5">CNode::CNode</a></div><div class="ttdeci">CNode()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:719</div></div>
<div class="ttc" id="vecrand_8hpp_html_aba18dc05b48d6b6580d8b1b77a876a81"><div class="ttname"><a href="vecrand_8hpp.html#aba18dc05b48d6b6580d8b1b77a876a81">flt</a></div><div class="ttdeci">double flt</div><div class="ttdoc">The basic floating point type used in the simulations. </div><div class="ttdef"><b>Definition:</b> vecrand.hpp:43</div></div>
<div class="ttc" id="class_jamming_tree_html_acea970f4942b9fc46c9182a8dac390b8"><div class="ttname"><a href="class_jamming_tree.html#acea970f4942b9fc46c9182a8dac390b8">JammingTree::expand</a></div><div class="ttdeci">bool expand()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:479</div></div>
<div class="ttc" id="class_c_node_path_html_a1503a97fceebe308da3a1729318b7b59"><div class="ttname"><a href="class_c_node_path.html#a1503a97fceebe308da3a1729318b7b59">CNodePath::size</a></div><div class="ttdeci">uint size()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:739</div></div>
<div class="ttc" id="struct_atom_html_a2e822a6b4d6d55d74671b95b1be1f785"><div class="ttname"><a href="struct_atom.html#a2e822a6b4d6d55d74671b95b1be1f785">Atom::v</a></div><div class="ttdeci">Vec v</div><div class="ttdoc">velocity </div><div class="ttdef"><b>Definition:</b> box.hpp:223</div></div>
<div class="ttc" id="class_c_node_html_a9a96d5aab5f529da0e4cb392d994daed"><div class="ttname"><a href="class_c_node.html#a9a96d5aab5f529da0e4cb392d994daed">CNode::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(const CNode &amp;other) const </div><div class="ttdef"><b>Definition:</b> constraints.hpp:724</div></div>
<div class="ttc" id="class_i_s_f_tracker_html_ab5e5c93998d3df2715208807c02c62f0"><div class="ttname"><a href="class_i_s_f_tracker.html#ab5e5c93998d3df2715208807c02c62f0">ISFTracker::singles</a></div><div class="ttdeci">vector&lt; ISFTracker1 &gt; singles</div><div class="ttdef"><b>Definition:</b> constraints.hpp:378</div></div>
<div class="ttc" id="class_linear_constraint_html_abbb34f21cfddbb48c0c44e21d476fd92"><div class="ttname"><a href="class_linear_constraint.html#abbb34f21cfddbb48c0c44e21d476fd92">LinearConstraint::LinearConstraint</a></div><div class="ttdeci">LinearConstraint(sptr&lt; AtomGroup &gt; atms, flt dist)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:176</div></div>
<div class="ttc" id="class_c_node_html_a7453a05ead8a62aaf1ee156b31c21f75"><div class="ttname"><a href="class_c_node.html#a7453a05ead8a62aaf1ee156b31c21f75">CNode::x</a></div><div class="ttdeci">Vec x</div><div class="ttdef"><b>Definition:</b> constraints.hpp:717</div></div>
<div class="ttc" id="class_energy_tracker_html"><div class="ttname"><a href="class_energy_tracker.html">EnergyTracker</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:261</div></div>
<div class="ttc" id="class_jamming_tree_html_a8d9c6b28f7bd3e65417f7fc77a7bda3c"><div class="ttname"><a href="class_jamming_tree.html#a8d9c6b28f7bd3e65417f7fc77a7bda3c">JammingTree::size</a></div><div class="ttdeci">uint size()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:533</div></div>
<div class="ttc" id="class_smooth_locs_html_a92f5251039b1cb187e19ce62c668e6d5"><div class="ttname"><a href="class_smooth_locs.html#a92f5251039b1cb187e19ce62c668e6d5">SmoothLocs::smoothn</a></div><div class="ttdeci">uint smoothn</div><div class="ttdef"><b>Definition:</b> constraints.hpp:400</div></div>
<div class="ttc" id="class_jamming_list_rot_html_aaedc34cc7d4a6a707e76ae131a984cea"><div class="ttname"><a href="class_jamming_list_rot.html#aaedc34cc7d4a6a707e76ae131a984cea">JammingListRot::JammingListRot</a></div><div class="ttdeci">JammingListRot(const JammingListRot &amp;other, uint expand, flt addeddist)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:546</div></div>
<div class="ttc" id="class_coord_constraint_html_ac3c8500e01d767afade961496c4b9590"><div class="ttname"><a href="class_coord_constraint.html#ac3c8500e01d767afade961496c4b9590">CoordConstraint::apply</a></div><div class="ttdeci">void apply(Box &amp;box)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:37</div></div>
<div class="ttc" id="class_energy_tracker_html_a8999e08fbf5e88a9cf9f1c1f326b69c0"><div class="ttname"><a href="class_energy_tracker.html#a8999e08fbf5e88a9cf9f1c1f326b69c0">EnergyTracker::atoms</a></div><div class="ttdeci">sptr&lt; AtomGroup &gt; atoms</div><div class="ttdef"><b>Definition:</b> constraints.hpp:263</div></div>
<div class="ttc" id="class_jamming_list_html_a34a07577ff4247dd56473310c7d6078d"><div class="ttname"><a href="class_jamming_list.html#a34a07577ff4247dd56473310c7d6078d">JammingList::distsq</a></div><div class="ttdeci">flt distsq</div><div class="ttdef"><b>Definition:</b> constraints.hpp:449</div></div>
<div class="ttc" id="class_origin_box_html"><div class="ttname"><a href="class_origin_box.html">OriginBox</a></div><div class="ttdoc">A rectilinear Box, with periodic boundary conditions. </div><div class="ttdef"><b>Definition:</b> box.hpp:100</div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="class_jamming_tree2_html_a07e970229143e9cf09e56d1b3e7f26b2"><div class="ttname"><a href="class_jamming_tree2.html#a07e970229143e9cf09e56d1b3e7f26b2">JammingTree2::expand</a></div><div class="ttdeci">virtual bool expand()</div><div class="ttdef"><b>Definition:</b> constraints.cpp:555</div></div>
<div class="ttc" id="class_r_diffs_html_a4a31c1226380dc54b8ea7ed4e6369a45"><div class="ttname"><a href="class_r_diffs.html#a4a31c1226380dc54b8ea7ed4e6369a45">RDiffs::curt</a></div><div class="ttdeci">unsigned long curt</div><div class="ttdef"><b>Definition:</b> constraints.hpp:425</div></div>
<div class="ttc" id="class_smooth_locs_html_ac10d9b9fbc5e1c7673ead640356e45f6"><div class="ttname"><a href="class_smooth_locs.html#ac10d9b9fbc5e1c7673ead640356e45f6">SmoothLocs::smooth_locs</a></div><div class="ttdeci">vector&lt; vector&lt; Vec &gt; &gt; smooth_locs()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:414</div></div>
<div class="ttc" id="class_i_s_f_tracker1_html_aef1105b83096742f8de84db09fe311ed"><div class="ttname"><a href="class_i_s_f_tracker1.html#aef1105b83096742f8de84db09fe311ed">ISFTracker1::get_skip</a></div><div class="ttdeci">unsigned long get_skip()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:371</div></div>
<div class="ttc" id="class_rsq_tracker_html_a0f124aa083fbb30f654bf845afb135bf"><div class="ttname"><a href="class_rsq_tracker.html#a0f124aa083fbb30f654bf845afb135bf">RsqTracker::singles</a></div><div class="ttdeci">vector&lt; RsqTracker1 &gt; singles</div><div class="ttdef"><b>Definition:</b> constraints.hpp:330</div></div>
<div class="ttc" id="class_contact_tracker_html_a3f4b03698fa20ea84b4c48f62278f703"><div class="ttname"><a href="class_contact_tracker.html#a3f4b03698fa20ea84b4c48f62278f703">ContactTracker::dists</a></div><div class="ttdeci">vector&lt; flt &gt; dists</div><div class="ttdef"><b>Definition:</b> constraints.hpp:238</div></div>
<div class="ttc" id="class_smooth_locs_html_ac661162122797fe0e6e90c5715b28083"><div class="ttname"><a href="class_smooth_locs.html#ac661162122797fe0e6e90c5715b28083">SmoothLocs::atoms</a></div><div class="ttdeci">sptr&lt; AtomGroup &gt; atoms</div><div class="ttdef"><b>Definition:</b> constraints.hpp:399</div></div>
<div class="ttc" id="class_jamming_tree2_html_a56c397c705d88ab4aebe80ba391aaf43"><div class="ttname"><a href="class_jamming_tree2.html#a56c397c705d88ab4aebe80ba391aaf43">JammingTree2::~JammingTree2</a></div><div class="ttdeci">virtual ~JammingTree2()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:620</div></div>
<div class="ttc" id="class_smooth_locs_html_a14849f8023363564e19822e25a22e558"><div class="ttname"><a href="class_smooth_locs.html#a14849f8023363564e19822e25a22e558">SmoothLocs::skipn</a></div><div class="ttdeci">uint skipn</div><div class="ttdef"><b>Definition:</b> constraints.hpp:401</div></div>
<div class="ttc" id="class_rsq_tracker1_html_a949cd5663c270a95c9826f87b4ab2035"><div class="ttname"><a href="class_rsq_tracker1.html#a949cd5663c270a95c9826f87b4ab2035">RsqTracker1::get_skip</a></div><div class="ttdeci">unsigned long get_skip()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:323</div></div>
<div class="ttc" id="class_jamming_tree2_html_ac3f75594659c0951880d6d0a123c781d"><div class="ttname"><a href="class_jamming_tree2.html#ac3f75594659c0951880d6d0a123c781d">JammingTree2::copylist</a></div><div class="ttdeci">list&lt; JammingListRot &gt; copylist(uint n)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:588</div></div>
<div class="ttc" id="class_atom_i_d_html"><div class="ttname"><a href="class_atom_i_d.html">AtomID</a></div><div class="ttdoc">A pointer to an Atom, that also knows its own index in an AtomVec. </div><div class="ttdef"><b>Definition:</b> box.hpp:259</div></div>
<div class="ttc" id="class_jamming_tree_b_d_html_a7f5e926c7a274fc354eea40f8b86ab35"><div class="ttname"><a href="class_jamming_tree_b_d.html#a7f5e926c7a274fc354eea40f8b86ab35">JammingTreeBD::cutoff2</a></div><div class="ttdeci">uint cutoff2</div><div class="ttdef"><b>Definition:</b> constraints.hpp:640</div></div>
<div class="ttc" id="class_jamming_tree_b_d_html_ad1fd076a782dea297d69caa5b36db751"><div class="ttname"><a href="class_jamming_tree_b_d.html#ad1fd076a782dea297d69caa5b36db751">JammingTreeBD::JammingTreeBD</a></div><div class="ttdeci">JammingTreeBD(sptr&lt; Box &gt;box, vector&lt; Vec &gt; &amp;A, vector&lt; Vec &gt; &amp;B, uint cutoff)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:642</div></div>
<div class="ttc" id="class_jamming_tree2_html_a58010eabf4da6aa6e9d73c2f82783350"><div class="ttname"><a href="class_jamming_tree2.html#a58010eabf4da6aa6e9d73c2f82783350">JammingTree2::expandto</a></div><div class="ttdeci">bool expandto(flt maxdistsq)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:576</div></div>
<div class="ttc" id="class_energy_tracker_html_ac8400e2fcde88daa5656e1289fb66781"><div class="ttname"><a href="class_energy_tracker.html#ac8400e2fcde88daa5656e1289fb66781">EnergyTracker::Us</a></div><div class="ttdeci">flt Us</div><div class="ttdef"><b>Definition:</b> constraints.hpp:269</div></div>
<div class="ttc" id="class_c_node_html_aae3afff4d45adf923d66cab84494a289"><div class="ttname"><a href="class_c_node.html#aae3afff4d45adf923d66cab84494a289">CNode::operator==</a></div><div class="ttdeci">bool operator==(const CNode &amp;other) const </div><div class="ttdef"><b>Definition:</b> constraints.hpp:723</div></div>
<div class="ttc" id="class_energy_tracker_html_a6e664c973e70302e80a9acc225a1a5f2"><div class="ttname"><a href="class_energy_tracker.html#a6e664c973e70302e80a9acc225a1a5f2">EnergyTracker::n</a></div><div class="ttdeci">uint n()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:301</div></div>
<div class="ttc" id="class_num_vector_html_a603fd5ea813e3d650e0321c56fd7681e"><div class="ttname"><a href="class_num_vector.html#a603fd5ea813e3d650e0321c56fd7681e">NumVector::mag</a></div><div class="ttdeci">T mag() const </div><div class="ttdoc">The square of the vector, . </div><div class="ttdef"><b>Definition:</b> vec.hpp:117</div></div>
<div class="ttc" id="class_smooth_locs_html_aedb148dc27a2a603cfb01814d0854ca7"><div class="ttname"><a href="class_smooth_locs.html#aedb148dc27a2a603cfb01814d0854ca7">SmoothLocs::locs</a></div><div class="ttdeci">vector&lt; vector&lt; Vec &gt; &gt; locs</div><div class="ttdef"><b>Definition:</b> constraints.hpp:404</div></div>
<div class="ttc" id="class_energy_tracker_html_af6623a30dd262c23d434ceac35abc077"><div class="ttname"><a href="class_energy_tracker.html#af6623a30dd262c23d434ceac35abc077">EnergyTracker::interactions</a></div><div class="ttdeci">vector&lt; sptr&lt; Interaction &gt; &gt; interactions</div><div class="ttdef"><b>Definition:</b> constraints.hpp:264</div></div>
<div class="ttc" id="class_c_node_path_html_a998869fe7400bcac2a21d55a0dbc9b5e"><div class="ttname"><a href="class_c_node_path.html#a998869fe7400bcac2a21d55a0dbc9b5e">CNodePath::CNodePath</a></div><div class="ttdeci">CNodePath(CNode node)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:735</div></div>
<div class="ttc" id="class_smooth_locs_html"><div class="ttname"><a href="class_smooth_locs.html">SmoothLocs</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:397</div></div>
<div class="ttc" id="class_r_diffs_html_a3f3ea578bef9f170056ea12bcd2e109d"><div class="ttname"><a href="class_r_diffs.html#a3f3ea578bef9f170056ea12bcd2e109d">RDiffs::skip</a></div><div class="ttdeci">unsigned long skip</div><div class="ttdef"><b>Definition:</b> constraints.hpp:424</div></div>
<div class="ttc" id="class_jamming_list_html_a2c07970ca0c85377a1db8a67fa4c5a7c"><div class="ttname"><a href="class_jamming_list.html#a2c07970ca0c85377a1db8a67fa4c5a7c">JammingList::size</a></div><div class="ttdeci">uint size() const </div><div class="ttdef"><b>Definition:</b> constraints.hpp:461</div></div>
<div class="ttc" id="class_i_s_f_tracker_html_a99b6bdf4b8c3fb5f281264bbe1dd731e"><div class="ttname"><a href="class_i_s_f_tracker.html#a99b6bdf4b8c3fb5f281264bbe1dd731e">ISFTracker::atoms</a></div><div class="ttdeci">sptr&lt; AtomGroup &gt; atoms</div><div class="ttdef"><b>Definition:</b> constraints.hpp:377</div></div>
<div class="ttc" id="class_jamming_tree_html_a081e72e859185b65b41e291cd555fbd2"><div class="ttname"><a href="class_jamming_tree.html#a081e72e859185b65b41e291cd555fbd2">JammingTree::expand</a></div><div class="ttdeci">bool expand(uint n)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:515</div></div>
<div class="ttc" id="class_coord_c_o_m_constraint_html_aafdd12c0fa33fd878946aa070a67f684"><div class="ttname"><a href="class_coord_c_o_m_constraint.html#aafdd12c0fa33fd878946aa070a67f684">CoordCOMConstraint::CoordCOMConstraint</a></div><div class="ttdeci">CoordCOMConstraint(sptr&lt; AtomGroup &gt; atm, bool fixx, bool fixy, bool fixz, Vec loc)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:53</div></div>
<div class="ttc" id="class_energy_tracker_html_aea8afe5a55d082adb681979d16b417f1"><div class="ttname"><a href="class_energy_tracker.html#aea8afe5a55d082adb681979d16b417f1">EnergyTracker::Esqmean</a></div><div class="ttdeci">flt Esqmean()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:296</div></div>
<div class="ttc" id="class_jamming_tree2_html_a600c8887f767080548ff82b3a3afd4cb"><div class="ttname"><a href="class_jamming_tree2.html#a600c8887f767080548ff82b3a3afd4cb">JammingTree2::locationsA</a></div><div class="ttdeci">vector&lt; Vec &gt; locationsA()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:619</div></div>
<div class="ttc" id="class_c_node_path_html_ac5ec833a6f8aae17311f68964411ce44"><div class="ttname"><a href="class_c_node_path.html#ac5ec833a6f8aae17311f68964411ce44">CNodePath::CNodePath</a></div><div class="ttdeci">CNodePath()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:734</div></div>
<div class="ttc" id="class_r_diffs_html"><div class="ttname"><a href="class_r_diffs.html">RDiffs</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:418</div></div>
<div class="ttc" id="class_jamming_tree2_html_ab7c6385a76250e0c72dd8b763de5e4c1"><div class="ttname"><a href="class_jamming_tree2.html#ab7c6385a76250e0c72dd8b763de5e4c1">JammingTree2::mylist</a></div><div class="ttdeci">list&lt; JammingListRot &gt; &amp; mylist()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:586</div></div>
<div class="ttc" id="class_relative_constraint_html_a7f2e99140aa174826d4ffe85ad256af9"><div class="ttname"><a href="class_relative_constraint.html#a7f2e99140aa174826d4ffe85ad256af9">RelativeConstraint::apply</a></div><div class="ttdeci">void apply(Box &amp;box)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:98</div></div>
<div class="ttc" id="class_energy_tracker_html_a1e784ad0787c2719d2e40ce36267ed09"><div class="ttname"><a href="class_energy_tracker.html#a1e784ad0787c2719d2e40ce36267ed09">EnergyTracker::getU0</a></div><div class="ttdeci">flt getU0()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:288</div></div>
<div class="ttc" id="class_jamming_list_rot_html_ab4dd65c07932cb6d3bb80130d7b9d9ed"><div class="ttname"><a href="class_jamming_list_rot.html#ab4dd65c07932cb6d3bb80130d7b9d9ed">JammingListRot::rotation</a></div><div class="ttdeci">uint rotation</div><div class="ttdef"><b>Definition:</b> constraints.hpp:540</div></div>
<div class="ttc" id="class_energy_tracker_html_abc220c377db5ec029c57dbc2d2cb29ec"><div class="ttname"><a href="class_energy_tracker.html#abc220c377db5ec029c57dbc2d2cb29ec">EnergyTracker::Ustd</a></div><div class="ttdeci">flt Ustd()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:295</div></div>
<div class="ttc" id="class_c_node_path_html_a812d8493554ba776ee0f9a9856ab1367"><div class="ttname"><a href="class_c_node_path.html#a812d8493554ba776ee0f9a9856ab1367">CNodePath::CNodePath</a></div><div class="ttdeci">CNodePath(CNodePath other, CNode node, OriginBox &amp;box)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:736</div></div>
<div class="ttc" id="class_rsq_tracker1_html_a23c3a82bd57672b51bfcf8b2a5a6873b"><div class="ttname"><a href="class_rsq_tracker1.html#a23c3a82bd57672b51bfcf8b2a5a6873b">RsqTracker1::xyz2sums</a></div><div class="ttdeci">vector&lt; Vec &gt; xyz2sums</div><div class="ttdef"><b>Definition:</b> constraints.hpp:308</div></div>
<div class="ttc" id="class_coord_c_o_m_constraint_html_affc7af036b03efe17be9049ec997b4e2"><div class="ttname"><a href="class_coord_c_o_m_constraint.html#affc7af036b03efe17be9049ec997b4e2">CoordCOMConstraint::apply</a></div><div class="ttdeci">void apply(Box &amp;box)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:60</div></div>
<div class="ttc" id="class_jamming_list_rot_html"><div class="ttname"><a href="class_jamming_list_rot.html">JammingListRot</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:538</div></div>
<div class="ttc" id="struct_atom_html_a670588d361624516b330574fcfcb3e1a"><div class="ttname"><a href="struct_atom.html#a670588d361624516b330574fcfcb3e1a">Atom::f</a></div><div class="ttdeci">Vec f</div><div class="ttdoc">forces </div><div class="ttdef"><b>Definition:</b> box.hpp:229</div></div>
<div class="ttc" id="class_contact_tracker_html_ac10f430ae2791bd8a3c7f91dba68a204"><div class="ttname"><a href="class_contact_tracker.html#ac10f430ae2791bd8a3c7f91dba68a204">ContactTracker::number</a></div><div class="ttdeci">unsigned long long number()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:250</div></div>
<div class="ttc" id="class_jamming_tree2_html_a60e7f8b0408b17d12bf1efeff1e5e8dc"><div class="ttname"><a href="class_jamming_tree2.html#a60e7f8b0408b17d12bf1efeff1e5e8dc">JammingTree2::copylist</a></div><div class="ttdeci">list&lt; JammingListRot &gt; copylist()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:587</div></div>
<div class="ttc" id="class_energy_tracker_html_a265e6f30cbb6ad620e6b962f81fe57d5"><div class="ttname"><a href="class_energy_tracker.html#a265e6f30cbb6ad620e6b962f81fe57d5">EnergyTracker::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:278</div></div>
<div class="ttc" id="class_jamming_list_html_ae23d48d392b54ecce67f1e468350c501"><div class="ttname"><a href="class_jamming_list.html#ae23d48d392b54ecce67f1e468350c501">JammingList::assigned</a></div><div class="ttdeci">vector&lt; uint &gt; assigned</div><div class="ttdef"><b>Definition:</b> constraints.hpp:448</div></div>
<div class="ttc" id="class_contact_tracker_html_ae1a598eca5ece1cec374e7037d2d7333"><div class="ttname"><a href="class_contact_tracker.html#ae1a598eca5ece1cec374e7037d2d7333">ContactTracker::breaks</a></div><div class="ttdeci">unsigned long long breaks</div><div class="ttdef"><b>Definition:</b> constraints.hpp:241</div></div>
<div class="ttc" id="class_energy_tracker_html_af259293454641985a01978f0cd1fa7b8"><div class="ttname"><a href="class_energy_tracker.html#af259293454641985a01978f0cd1fa7b8">EnergyTracker::U</a></div><div class="ttdeci">flt U()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:291</div></div>
<div class="ttc" id="class_dist_constraint_html_ac5f88457e0ac34c9bb262565b31e6a1f"><div class="ttname"><a href="class_dist_constraint.html#ac5f88457e0ac34c9bb262565b31e6a1f">DistConstraint::DistConstraint</a></div><div class="ttdeci">DistConstraint(AtomID atm1, AtomID atm2)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:125</div></div>
<div class="ttc" id="class_jamming_tree2_html_ae921105d208e514f8389c8e8e1a1fcd9"><div class="ttname"><a href="class_jamming_tree2.html#ae921105d208e514f8389c8e8e1a1fcd9">JammingTree2::locationsB</a></div><div class="ttdeci">vector&lt; Vec &gt; locationsB()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:617</div></div>
<div class="ttc" id="class_smooth_locs_html_a435c08b9ce23a21a59f0b8af6cebe195"><div class="ttname"><a href="class_smooth_locs.html#a435c08b9ce23a21a59f0b8af6cebe195">SmoothLocs::curt</a></div><div class="ttdeci">unsigned long curt</div><div class="ttdef"><b>Definition:</b> constraints.hpp:405</div></div>
<div class="ttc" id="class_jamming_tree2_html"><div class="ttname"><a href="class_jamming_tree2.html">JammingTree2</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:553</div></div>
<div class="ttc" id="class_jamming_list_rot_html_ae0d542f308c9fd3cc6a6fd6a81c194df"><div class="ttname"><a href="class_jamming_list_rot.html#ae0d542f308c9fd3cc6a6fd6a81c194df">JammingListRot::JammingListRot</a></div><div class="ttdeci">JammingListRot(uint rot)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:543</div></div>
<div class="ttc" id="class_energy_tracker_html_a0399e1725ffcb9b4f12b646c01627484"><div class="ttname"><a href="class_energy_tracker.html#a0399e1725ffcb9b4f12b646c01627484">EnergyTracker::setU0</a></div><div class="ttdeci">void setU0(flt newU0)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:283</div></div>
<div class="ttc" id="class_energy_tracker_html_a281304d077243c03c1a13f2f35259852"><div class="ttname"><a href="class_energy_tracker.html#a281304d077243c03c1a13f2f35259852">EnergyTracker::N</a></div><div class="ttdeci">uint N</div><div class="ttdef"><b>Definition:</b> constraints.hpp:266</div></div>
<div class="ttc" id="class_relative_constraint_html_a1d6caf9f9b348b4a9c1fe8933362cff3"><div class="ttname"><a href="class_relative_constraint.html#a1d6caf9f9b348b4a9c1fe8933362cff3">RelativeConstraint::ndof</a></div><div class="ttdeci">int ndof()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:97</div></div>
<div class="ttc" id="class_contact_tracker_html_aa229c470aa5fd1dba674bbc57e5a806e"><div class="ttname"><a href="class_contact_tracker.html#aa229c470aa5fd1dba674bbc57e5a806e">ContactTracker::broken</a></div><div class="ttdeci">unsigned long long broken()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:248</div></div>
<div class="ttc" id="class_vector2_html"><div class="ttname"><a href="class_vector2.html">Vector2&lt; flt &gt;</a></div></div>
<div class="ttc" id="class_linear_constraint_html_a74fe045a3c6c1477e146113b5da16ced"><div class="ttname"><a href="class_linear_constraint.html#a74fe045a3c6c1477e146113b5da16ced">LinearConstraint::apply</a></div><div class="ttdeci">void apply(Box &amp;box)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:191</div></div>
<div class="ttc" id="class_relative_constraint_html"><div class="ttname"><a href="class_relative_constraint.html">RelativeConstraint</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:82</div></div>
<div class="ttc" id="class_contact_tracker_html"><div class="ttname"><a href="class_contact_tracker.html">ContactTracker</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:235</div></div>
<div class="ttc" id="class_energy_tracker_html_a3e8b8d6316f902ac49f0d5db52590c7e"><div class="ttname"><a href="class_energy_tracker.html#a3e8b8d6316f902ac49f0d5db52590c7e">EnergyTracker::Kstd</a></div><div class="ttdeci">flt Kstd()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:294</div></div>
<div class="ttc" id="class_energy_tracker_html_a5ccb73edc25cc508eed9b32c5ccdb5f3"><div class="ttname"><a href="class_energy_tracker.html#a5ccb73edc25cc508eed9b32c5ccdb5f3">EnergyTracker::nskipped</a></div><div class="ttdeci">uint nskipped</div><div class="ttdef"><b>Definition:</b> constraints.hpp:267</div></div>
<div class="ttc" id="class_rsq_tracker_html"><div class="ttname"><a href="class_rsq_tracker.html">RsqTracker</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:327</div></div>
<div class="ttc" id="class_c_node_html_a851ec2cb1c285639c17f14eb4e243325"><div class="ttname"><a href="class_c_node.html#a851ec2cb1c285639c17f14eb4e243325">CNode::operator!=</a></div><div class="ttdeci">bool operator!=(const CNode &amp;other) const </div><div class="ttdef"><b>Definition:</b> constraints.hpp:722</div></div>
<div class="ttc" id="class_r_diffs_html_a5b7a88666b6a1b6fb10bcf2950fb0c41"><div class="ttname"><a href="class_r_diffs.html#a5b7a88666b6a1b6fb10bcf2950fb0c41">RDiffs::atoms</a></div><div class="ttdeci">sptr&lt; AtomGroup &gt; atoms</div><div class="ttdef"><b>Definition:</b> constraints.hpp:421</div></div>
<div class="ttc" id="class_rsq_tracker1_html"><div class="ttname"><a href="class_rsq_tracker1.html">RsqTracker1</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:304</div></div>
<div class="ttc" id="class_linear_constraint_html_a49fa745cfe1be3d9b2675b6c69f9d5da"><div class="ttname"><a href="class_linear_constraint.html#a49fa745cfe1be3d9b2675b6c69f9d5da">LinearConstraint::ndof</a></div><div class="ttdeci">int ndof()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:189</div></div>
<div class="ttc" id="class_jamming_list_html_aff0d3da3074ea7d37d3458e4dc77c484"><div class="ttname"><a href="class_jamming_list.html#aff0d3da3074ea7d37d3458e4dc77c484">JammingList::JammingList</a></div><div class="ttdeci">JammingList(const JammingList &amp;other)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:452</div></div>
<div class="ttc" id="class_dist_constraint_html_a4f855326894a1fd6541b1d9246c97507"><div class="ttname"><a href="class_dist_constraint.html#a4f855326894a1fd6541b1d9246c97507">DistConstraint::ndof</a></div><div class="ttdeci">int ndof()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:127</div></div>
<div class="ttc" id="class_connectivity_html_af38ff9c44b157ba74e6a06e1452f63ef"><div class="ttname"><a href="class_connectivity.html#af38ff9c44b157ba74e6a06e1452f63ef">Connectivity::nodes</a></div><div class="ttdeci">set&lt; CNode &gt; nodes</div><div class="ttdef"><b>Definition:</b> constraints.hpp:751</div></div>
<div class="ttc" id="class_smooth_locs_html_a707d0e39085bfe24fe3940de12e54629"><div class="ttname"><a href="class_smooth_locs.html#a707d0e39085bfe24fe3940de12e54629">SmoothLocs::numincur</a></div><div class="ttdeci">uint numincur</div><div class="ttdef"><b>Definition:</b> constraints.hpp:403</div></div>
<div class="ttc" id="class_linear_constraint_html"><div class="ttname"><a href="class_linear_constraint.html">LinearConstraint</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:170</div></div>
<div class="ttc" id="class_i_s_f_tracker_html_a06a1d041e94b25f4c4bd66118ce89cbb"><div class="ttname"><a href="class_i_s_f_tracker.html#a06a1d041e94b25f4c4bd66118ce89cbb">ISFTracker::usecom</a></div><div class="ttdeci">bool usecom</div><div class="ttdef"><b>Definition:</b> constraints.hpp:380</div></div>
<div class="ttc" id="class_vector2_html_a3818d3aff9ed1bc7c21305b09fb33a8f"><div class="ttname"><a href="class_vector2.html#a3818d3aff9ed1bc7c21305b09fb33a8f">Vector2::norm</a></div><div class="ttdeci">Vector2 norm() const </div><div class="ttdoc">The normalized version of this vector. </div><div class="ttdef"><b>Definition:</b> vec.hpp:295</div></div>
<div class="ttc" id="class_energy_tracker_html_a3eceddb2389f3ca0a4f1d5456bcb54d2"><div class="ttname"><a href="class_energy_tracker.html#a3eceddb2389f3ca0a4f1d5456bcb54d2">EnergyTracker::E</a></div><div class="ttdeci">flt E()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:290</div></div>
<div class="ttc" id="class_jamming_tree2_html_a3d708531e96a7e2667b12e870849c75e"><div class="ttname"><a href="class_jamming_tree2.html#a3d708531e96a7e2667b12e870849c75e">JammingTree2::jlists</a></div><div class="ttdeci">list&lt; JammingListRot &gt; jlists</div><div class="ttdef"><b>Definition:</b> constraints.hpp:556</div></div>
<div class="ttc" id="class_c_node_html_a4c6976bcd30cf7257638ae368a4925a1"><div class="ttname"><a href="class_c_node.html#a4c6976bcd30cf7257638ae368a4925a1">CNode::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> constraints.hpp:716</div></div>
<div class="ttc" id="class_coord_constraint_html_ad62706cb02eba5424372911c14a184d6"><div class="ttname"><a href="class_coord_constraint.html#ad62706cb02eba5424372911c14a184d6">CoordConstraint::ndof</a></div><div class="ttdeci">int ndof()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:36</div></div>
<div class="ttc" id="class_jamming_tree2_html_af1c79da430cfc0606167c21e2f7ea232"><div class="ttname"><a href="class_jamming_tree2.html#af1c79da430cfc0606167c21e2f7ea232">JammingTree2::curbest</a></div><div class="ttdeci">JammingListRot curbest()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:595</div></div>
<div class="ttc" id="class_dist_constraint_html_aaafab0d44c9c3c07b59498c2c7613cf4"><div class="ttname"><a href="class_dist_constraint.html#aaafab0d44c9c3c07b59498c2c7613cf4">DistConstraint::apply</a></div><div class="ttdeci">void apply(Box &amp;box)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:128</div></div>
<div class="ttc" id="class_relative_constraint_html_aa9469e72ec7580e59bf05b81143e95f0"><div class="ttname"><a href="class_relative_constraint.html#aa9469e72ec7580e59bf05b81143e95f0">RelativeConstraint::RelativeConstraint</a></div><div class="ttdeci">RelativeConstraint(Atom *atm1, Atom *atm2, bool fixx, bool fixy, bool fixz, Vec loc)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:88</div></div>
<div class="ttc" id="class_connectivity_html_ab8feefc9918cca72b803df732c4fa620"><div class="ttname"><a href="class_connectivity.html#ab8feefc9918cca72b803df732c4fa620">Connectivity::box</a></div><div class="ttdeci">sptr&lt; OriginBox &gt; box</div><div class="ttdef"><b>Definition:</b> constraints.hpp:750</div></div>
<div class="ttc" id="class_smooth_locs_html_acc3d3c7093af705c807ea5cef9d23ac1"><div class="ttname"><a href="class_smooth_locs.html#acc3d3c7093af705c807ea5cef9d23ac1">SmoothLocs::curlocs</a></div><div class="ttdeci">vector&lt; Vec &gt; curlocs</div><div class="ttdef"><b>Definition:</b> constraints.hpp:402</div></div>
<div class="ttc" id="class_state_tracker_html"><div class="ttname"><a href="class_state_tracker.html">StateTracker</a></div><div class="ttdoc">The general interface for a "tracker", a class that needs to be called every timestep. </div><div class="ttdef"><b>Definition:</b> trackers.hpp:16</div></div>
<div class="ttc" id="class_contact_tracker_html_ad7516ade412ead0080e91406325afe65"><div class="ttname"><a href="class_contact_tracker.html#ad7516ade412ead0080e91406325afe65">ContactTracker::contacts</a></div><div class="ttdeci">vector&lt; vector&lt; bool &gt; &gt; contacts</div><div class="ttdef"><b>Definition:</b> constraints.hpp:239</div></div>
<div class="ttc" id="constraints_8hpp_html_a98875dff65ee903f41a7ae62c696f935"><div class="ttname"><a href="constraints_8hpp.html#a98875dff65ee903f41a7ae62c696f935">cmplx</a></div><div class="ttdeci">std::complex&lt; flt &gt; cmplx</div><div class="ttdef"><b>Definition:</b> constraints.hpp:15</div></div>
<div class="ttc" id="class_jamming_list_html"><div class="ttname"><a href="class_jamming_list.html">JammingList</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:446</div></div>
<div class="ttc" id="class_jamming_tree_b_d_html_a8f5b0e7fd87e308ec2f57a9e1c20900a"><div class="ttname"><a href="class_jamming_tree_b_d.html#a8f5b0e7fd87e308ec2f57a9e1c20900a">JammingTreeBD::expand</a></div><div class="ttdeci">bool expand(uint n)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:650</div></div>
<div class="ttc" id="interaction_8hpp_html"><div class="ttname"><a href="interaction_8hpp.html">interaction.hpp</a></div></div>
<div class="ttc" id="class_i_s_f_tracker_html_a3683f0399c9cc8ce8dd237288f739d73"><div class="ttname"><a href="class_i_s_f_tracker.html#a3683f0399c9cc8ce8dd237288f739d73">ISFTracker::curt</a></div><div class="ttdeci">unsigned long curt</div><div class="ttdef"><b>Definition:</b> constraints.hpp:379</div></div>
<div class="ttc" id="class_energy_tracker_html_aa1bafcc92891abf51aeaf47d72ef98e1"><div class="ttname"><a href="class_energy_tracker.html#aa1bafcc92891abf51aeaf47d72ef98e1">EnergyTracker::EnergyTracker</a></div><div class="ttdeci">EnergyTracker(sptr&lt; AtomGroup &gt; atoms, vector&lt; sptr&lt; Interaction &gt; &gt; interactions, uint nskip=1)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:272</div></div>
<div class="ttc" id="class_vector2_html_a198662fae516fb6a0e68762c4ebde34a"><div class="ttname"><a href="class_vector2.html#a198662fae516fb6a0e68762c4ebde34a">Vector2::cross</a></div><div class="ttdeci">T cross(const Vector2 &amp;rhs) const </div><div class="ttdoc">The 2D cross product, returning a scalar. </div><div class="ttdef"><b>Definition:</b> vec.hpp:289</div></div>
<div class="ttc" id="vecrand_8hpp_html_a2b1fd2d28c6a7d4a3f7027cc1b6466f3"><div class="ttname"><a href="vecrand_8hpp.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a></div><div class="ttdeci">#define NDIM</div><div class="ttdef"><b>Definition:</b> vecrand.hpp:11</div></div>
<div class="ttc" id="class_i_s_f_tracker_html"><div class="ttname"><a href="class_i_s_f_tracker.html">ISFTracker</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:375</div></div>
<div class="ttc" id="class_contact_tracker_html_af45f49633ef3d6ece7ab2020b16c4f68"><div class="ttname"><a href="class_contact_tracker.html#af45f49633ef3d6ece7ab2020b16c4f68">ContactTracker::incontact</a></div><div class="ttdeci">unsigned long long incontact</div><div class="ttdef"><b>Definition:</b> constraints.hpp:243</div></div>
<div class="ttc" id="class_relative_constraint_html_a25aed0f2eb158361eecfb33dce5748ec"><div class="ttname"><a href="class_relative_constraint.html#a25aed0f2eb158361eecfb33dce5748ec">RelativeConstraint::RelativeConstraint</a></div><div class="ttdeci">RelativeConstraint(Atom *atm1, Atom *atm2, bool fixx, bool fixy, bool fixz)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:91</div></div>
<div class="ttc" id="class_jamming_tree_html_a82be0a097959e3dde6396fc8cb6a3729"><div class="ttname"><a href="class_jamming_tree.html#a82be0a097959e3dde6396fc8cb6a3729">JammingTree::mylist</a></div><div class="ttdeci">list&lt; JammingList &gt; &amp; mylist()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:522</div></div>
<div class="ttc" id="class_c_node_html_afa985f833a9c58c5bb0012f6167b7bc1"><div class="ttname"><a href="class_c_node.html#afa985f833a9c58c5bb0012f6167b7bc1">CNode::CNode</a></div><div class="ttdeci">CNode(int n, Vec x)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:720</div></div>
<div class="ttc" id="class_i_s_f_tracker1_html_a0bdef0f1a23635870011427c86689061"><div class="ttname"><a href="class_i_s_f_tracker1.html#a0bdef0f1a23635870011427c86689061">ISFTracker1::get_count</a></div><div class="ttdeci">unsigned long get_count()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:372</div></div>
<div class="ttc" id="class_jamming_tree_html"><div class="ttname"><a href="class_jamming_tree.html">JammingTree</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:466</div></div>
<div class="ttc" id="class_coord_c_o_m_constraint_html"><div class="ttname"><a href="class_coord_c_o_m_constraint.html">CoordCOMConstraint</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:47</div></div>
<div class="ttc" id="class_connectivity_html"><div class="ttname"><a href="class_connectivity.html">Connectivity</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:748</div></div>
<div class="ttc" id="class_jamming_tree_html_a78614c6c0e70e0ee58061b62c89b0a3d"><div class="ttname"><a href="class_jamming_tree.html#a78614c6c0e70e0ee58061b62c89b0a3d">JammingTree::curbest</a></div><div class="ttdeci">JammingList curbest()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:525</div></div>
<div class="ttc" id="class_i_s_f_tracker1_html"><div class="ttname"><a href="class_i_s_f_tracker1.html">ISFTracker1</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:354</div></div>
<div class="ttc" id="class_jamming_tree_html_adf155379664e999aa7b51c9379c2f553"><div class="ttname"><a href="class_jamming_tree.html#adf155379664e999aa7b51c9379c2f553">JammingTree::JammingTree</a></div><div class="ttdeci">JammingTree(sptr&lt; Box &gt; box, vector&lt; Vec &gt; &amp;A, vector&lt; Vec &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:473</div></div>
<div class="ttc" id="class_coord_constraint_html_a6a2c918ebf70b16989b59995aaa94247"><div class="ttname"><a href="class_coord_constraint.html#a6a2c918ebf70b16989b59995aaa94247">CoordConstraint::CoordConstraint</a></div><div class="ttdeci">CoordConstraint(Atom *atm, bool fixx, bool fixy, bool fixz, Vec loc)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:30</div></div>
<div class="ttc" id="class_connectivity_html_a1cd65e0f1306878804459294114589a2"><div class="ttname"><a href="class_connectivity.html#a1cd65e0f1306878804459294114589a2">Connectivity::neighbors</a></div><div class="ttdeci">map&lt; int, vector&lt; CNode &gt; &gt; neighbors</div><div class="ttdef"><b>Definition:</b> constraints.hpp:752</div></div>
<div class="ttc" id="class_box_html"><div class="ttname"><a href="class_box.html">Box</a></div><div class="ttdoc">The virtual interface for the shape of the space and its boundaries. </div><div class="ttdef"><b>Definition:</b> box.hpp:52</div></div>
<div class="ttc" id="class_dist_constraint_html"><div class="ttname"><a href="class_dist_constraint.html">DistConstraint</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:118</div></div>
<div class="ttc" id="constraints_8hpp_html_a56a7f494546ed50e702ccbb3943ab5fa"><div class="ttname"><a href="constraints_8hpp.html#a56a7f494546ed50e702ccbb3943ab5fa">ContactTrackerD</a></div><div class="ttdeci">ContactTracker * ContactTrackerD(sptr&lt; Box &gt; box, sptr&lt; AtomGroup &gt; atoms, vector&lt; double &gt; dists)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:253</div></div>
<div class="ttc" id="class_contact_tracker_html_a4c28b274a2020a88c9b3375d0dc174c6"><div class="ttname"><a href="class_contact_tracker.html#a4c28b274a2020a88c9b3375d0dc174c6">ContactTracker::atoms</a></div><div class="ttdeci">sptr&lt; AtomGroup &gt; atoms</div><div class="ttdef"><b>Definition:</b> constraints.hpp:237</div></div>
<div class="ttc" id="class_rsq_tracker_html_a486be6fb242cfe75454f71b44fccecc3"><div class="ttname"><a href="class_rsq_tracker.html#a486be6fb242cfe75454f71b44fccecc3">RsqTracker::usecom</a></div><div class="ttdeci">bool usecom</div><div class="ttdef"><b>Definition:</b> constraints.hpp:332</div></div>
<div class="ttc" id="class_c_node_html"><div class="ttname"><a href="class_c_node.html">CNode</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:714</div></div>
<div class="ttc" id="class_jamming_list_html_a0c1f149e504ce5373049052816441ef9"><div class="ttname"><a href="class_jamming_list.html#a0c1f149e504ce5373049052816441ef9">JammingList::JammingList</a></div><div class="ttdeci">JammingList()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:451</div></div>
<div class="ttc" id="class_coord_c_o_m_constraint_html_a93fa3f04c500431f9e91f272330742ac"><div class="ttname"><a href="class_coord_c_o_m_constraint.html#a93fa3f04c500431f9e91f272330742ac">CoordCOMConstraint::CoordCOMConstraint</a></div><div class="ttdeci">CoordCOMConstraint(sptr&lt; AtomGroup &gt; atm)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:57</div></div>
<div class="ttc" id="class_rsq_tracker1_html_a64f4cd5942c1bc9f5c97eb72c29aaf62"><div class="ttname"><a href="class_rsq_tracker1.html#a64f4cd5942c1bc9f5c97eb72c29aaf62">RsqTracker1::skip</a></div><div class="ttdeci">unsigned long skip</div><div class="ttdef"><b>Definition:</b> constraints.hpp:311</div></div>
<div class="ttc" id="class_jamming_list_rot_html_a4a9c2509801e5b21dff34f6ddd1ff991"><div class="ttname"><a href="class_jamming_list_rot.html#a4a9c2509801e5b21dff34f6ddd1ff991">JammingListRot::JammingListRot</a></div><div class="ttdeci">JammingListRot()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:542</div></div>
<div class="ttc" id="class_rsq_tracker_html_a6dd206661ae1eaca4257b1538e79b005"><div class="ttname"><a href="class_rsq_tracker.html#a6dd206661ae1eaca4257b1538e79b005">RsqTracker::atoms</a></div><div class="ttdeci">sptr&lt; AtomGroup &gt; atoms</div><div class="ttdef"><b>Definition:</b> constraints.hpp:329</div></div>
<div class="ttc" id="class_jamming_list_html_ac776dd9ea451af91ef4398c6b13b76f9"><div class="ttname"><a href="class_jamming_list.html#ac776dd9ea451af91ef4398c6b13b76f9">JammingList::JammingList</a></div><div class="ttdeci">JammingList(const JammingList &amp;other, uint expand, flt addeddist)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:454</div></div>
<div class="ttc" id="class_c_node_html_a5370ebfe28147d9fa550dae7ae403b85"><div class="ttname"><a href="class_c_node.html#a5370ebfe28147d9fa550dae7ae403b85">CNode::operator&gt;</a></div><div class="ttdeci">bool operator&gt;(const CNode &amp;other) const </div><div class="ttdef"><b>Definition:</b> constraints.hpp:725</div></div>
<div class="ttc" id="class_r_diffs_html_ab7293852aaa1bee9283da60f78f8b934"><div class="ttname"><a href="class_r_diffs.html#ab7293852aaa1bee9283da60f78f8b934">RDiffs::usecom</a></div><div class="ttdeci">bool usecom</div><div class="ttdef"><b>Definition:</b> constraints.hpp:426</div></div>
<div class="ttc" id="class_rsq_tracker1_html_a737f29d07b124998250f4c0e808f760c"><div class="ttname"><a href="class_rsq_tracker1.html#a737f29d07b124998250f4c0e808f760c">RsqTracker1::r4sums</a></div><div class="ttdeci">vector&lt; flt &gt; r4sums</div><div class="ttdef"><b>Definition:</b> constraints.hpp:310</div></div>
<div class="ttc" id="class_energy_tracker_html_a827ccea7b8f77d54c7a30cf9d52a8dfc"><div class="ttname"><a href="class_energy_tracker.html#a827ccea7b8f77d54c7a30cf9d52a8dfc">EnergyTracker::U0</a></div><div class="ttdeci">flt U0</div><div class="ttdef"><b>Definition:</b> constraints.hpp:268</div></div>
<div class="ttc" id="class_relative_constraint_html_a2f510e334367044ea56ceb73e38bc57a"><div class="ttname"><a href="class_relative_constraint.html#a2f510e334367044ea56ceb73e38bc57a">RelativeConstraint::RelativeConstraint</a></div><div class="ttdeci">RelativeConstraint(Atom *atm1, Atom *atm2)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:94</div></div>
<div class="ttc" id="class_jamming_tree2_html_a07a9f1781a298d3f7343ec6a1bf25672"><div class="ttname"><a href="class_jamming_tree2.html#a07a9f1781a298d3f7343ec6a1bf25672">JammingTree2::box</a></div><div class="ttdeci">sptr&lt; Box &gt; box</div><div class="ttdef"><b>Definition:</b> constraints.hpp:555</div></div>
<div class="ttc" id="class_coord_constraint_html_ab513edaad0d51b99defd564ce906ffd9"><div class="ttname"><a href="class_coord_constraint.html#ab513edaad0d51b99defd564ce906ffd9">CoordConstraint::CoordConstraint</a></div><div class="ttdeci">CoordConstraint(Atom *atm)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:34</div></div>
<div class="ttc" id="class_smooth_locs_html_a9cbd03e8474f5207f209f57cbc193182"><div class="ttname"><a href="class_smooth_locs.html#a9cbd03e8474f5207f209f57cbc193182">SmoothLocs::usecom</a></div><div class="ttdeci">bool usecom</div><div class="ttdef"><b>Definition:</b> constraints.hpp:406</div></div>
<div class="ttc" id="class_jamming_tree2_html_ae04554aa1577d868046f6dc42ca32958"><div class="ttname"><a href="class_jamming_tree2.html#ae04554aa1577d868046f6dc42ca32958">JammingTree2::size</a></div><div class="ttdeci">uint size()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:614</div></div>
<div class="ttc" id="class_dist_constraint_html_a34cc6aeba086a133c7f086439fa701af"><div class="ttname"><a href="class_dist_constraint.html#a34cc6aeba086a133c7f086439fa701af">DistConstraint::DistConstraint</a></div><div class="ttdeci">DistConstraint(AtomID atm1, AtomID atm2, flt dist)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:123</div></div>
<div class="ttc" id="class_i_s_f_tracker1_html_a0841df16cddc5b822f63e276ab985c2a"><div class="ttname"><a href="class_i_s_f_tracker1.html#a0841df16cddc5b822f63e276ab985c2a">ISFTracker1::pastlocs</a></div><div class="ttdeci">vector&lt; Vec &gt; pastlocs</div><div class="ttdef"><b>Definition:</b> constraints.hpp:357</div></div>
<div class="ttc" id="class_r_diffs_html_af4926545bd40f681d69063f849fb0f0f"><div class="ttname"><a href="class_r_diffs.html#af4926545bd40f681d69063f849fb0f0f">RDiffs::get_skip</a></div><div class="ttdeci">unsigned long get_skip()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:435</div></div>
<div class="ttc" id="class_i_s_f_tracker1_html_a1d4b05f07df1249d4e3c4bcc91ed96f7"><div class="ttname"><a href="class_i_s_f_tracker1.html#a1d4b05f07df1249d4e3c4bcc91ed96f7">ISFTracker1::skip</a></div><div class="ttdeci">unsigned long skip</div><div class="ttdef"><b>Definition:</b> constraints.hpp:360</div></div>
<div class="ttc" id="class_rsq_tracker1_html_aca582a0f71bc4646446eb74cd0cf305e"><div class="ttname"><a href="class_rsq_tracker1.html#aca582a0f71bc4646446eb74cd0cf305e">RsqTracker1::pastlocs</a></div><div class="ttdeci">vector&lt; Vec &gt; pastlocs</div><div class="ttdef"><b>Definition:</b> constraints.hpp:307</div></div>
<div class="ttc" id="class_c_node_path_html_a48f9ad48fa803948dcbbafd75ce4e127"><div class="ttname"><a href="class_c_node_path.html#a48f9ad48fa803948dcbbafd75ce4e127">CNodePath::distance</a></div><div class="ttdeci">Vec distance</div><div class="ttdef"><b>Definition:</b> constraints.hpp:730</div></div>
<div class="ttc" id="class_c_node_path_html"><div class="ttname"><a href="class_c_node_path.html">CNodePath</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:728</div></div>
<div class="ttc" id="class_i_s_f_tracker1_html_a12ac8e995f34d0a08245c86e0ccee90f"><div class="ttname"><a href="class_i_s_f_tracker1.html#a12ac8e995f34d0a08245c86e0ccee90f">ISFTracker1::ks</a></div><div class="ttdeci">vector&lt; flt &gt; ks</div><div class="ttdef"><b>Definition:</b> constraints.hpp:359</div></div>
<div class="ttc" id="class_rsq_tracker1_html_aa2f581a3ebeb03d0ed6d8cf5b47eed61"><div class="ttname"><a href="class_rsq_tracker1.html#aa2f581a3ebeb03d0ed6d8cf5b47eed61">RsqTracker1::get_count</a></div><div class="ttdeci">unsigned long get_count()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:324</div></div>
<div class="ttc" id="class_energy_tracker_html_aefad2a489a171015e071489ff62df45a"><div class="ttname"><a href="class_energy_tracker.html#aefad2a489a171015e071489ff62df45a">EnergyTracker::Ksqmean</a></div><div class="ttdeci">flt Ksqmean()</div><div class="ttdef"><b>Definition:</b> constraints.hpp:297</div></div>
<div class="ttc" id="class_constraint_html"><div class="ttname"><a href="class_constraint.html">Constraint</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:17</div></div>
<div class="ttc" id="class_jamming_tree_b_d_html"><div class="ttname"><a href="class_jamming_tree_b_d.html">JammingTreeBD</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:624</div></div>
<div class="ttc" id="class_coord_constraint_html_af7e5f2541fe439ce49575ed199deb228"><div class="ttname"><a href="class_coord_constraint.html#af7e5f2541fe439ce49575ed199deb228">CoordConstraint::CoordConstraint</a></div><div class="ttdeci">CoordConstraint(Atom *atm, bool fixx, bool fixy, bool fixz)</div><div class="ttdef"><b>Definition:</b> constraints.hpp:32</div></div>
<div class="ttc" id="class_rsq_tracker1_html_a414c619226bd107b30fb663b342a7cb7"><div class="ttname"><a href="class_rsq_tracker1.html#a414c619226bd107b30fb663b342a7cb7">RsqTracker1::xyz4sums</a></div><div class="ttdeci">vector&lt; Vec &gt; xyz4sums</div><div class="ttdef"><b>Definition:</b> constraints.hpp:309</div></div>
<div class="ttc" id="class_coord_constraint_html"><div class="ttname"><a href="class_coord_constraint.html">CoordConstraint</a></div><div class="ttdef"><b>Definition:</b> constraints.hpp:24</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 4 2015 13:59:29 for ParM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
